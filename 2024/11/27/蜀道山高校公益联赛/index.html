<!DOCTYPE html>
<html lang="zh-CN">
<head>
  <meta charset="UTF-8">
<meta name="viewport" content="width=device-width">
<meta name="theme-color" content="#222"><meta name="generator" content="Hexo 7.3.0">

  <link rel="apple-touch-icon" sizes="180x180" href="/images/apple-touch-icon-next.png">
  <link rel="icon" type="image/png" sizes="32x32" href="/images/favicon-32x32-next.png">
  <link rel="icon" type="image/png" sizes="16x16" href="/images/favicon-16x16-next.png">
  <link rel="mask-icon" href="/images/logo.svg" color="#222">

<link rel="stylesheet" href="/css/main.css">



<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.6.0/css/all.min.css" integrity="sha256-5eIC48iZUHmSlSUz9XtjRyK2mzQkHScZY1WdMaoz74E=" crossorigin="anonymous">
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/animate.css/3.1.1/animate.min.css" integrity="sha256-PR7ttpcvz8qrF57fur/yAx1qXMFJeJFiA6pSzWi0OIE=" crossorigin="anonymous">

<script class="next-config" data-name="main" type="application/json">{"hostname":"languag3.github.io","root":"/","images":"/images","scheme":"Muse","darkmode":false,"version":"8.21.1","exturl":false,"sidebar":{"position":"left","width_expanded":320,"width_dual_column":240,"display":"post","padding":18,"offset":12},"hljswrap":true,"copycode":{"enable":false,"style":null},"fold":{"enable":false,"height":500},"bookmark":{"enable":false,"color":"#222","save":"auto"},"mediumzoom":false,"lazyload":false,"pangu":false,"comments":{"style":"tabs","active":null,"storage":true,"lazyload":false,"nav":null},"stickytabs":true,"motion":{"enable":true,"async":false,"transition":{"menu_item":"fadeInDown","post_block":"fadeIn","post_header":"fadeInDown","post_body":"fadeInDown","coll_header":"fadeInLeft","sidebar":"fadeInUp"}},"i18n":{"placeholder":"搜索...","empty":"没有找到任何搜索结果：${query}","hits_time":"找到 ${hits} 个搜索结果（用时 ${time} 毫秒）","hits":"找到 ${hits} 个搜索结果"}}</script><script src="/js/config.js"></script>

    <meta name="description" content="闲着无聊随便出了几道题玩玩()">
<meta property="og:type" content="article">
<meta property="og:title" content="蜀道山高校公益联赛">
<meta property="og:url" content="https://languag3.github.io/2024/11/27/%E8%9C%80%E9%81%93%E5%B1%B1%E9%AB%98%E6%A0%A1%E5%85%AC%E7%9B%8A%E8%81%94%E8%B5%9B/index.html">
<meta property="og:site_name" content="languag3">
<meta property="og:description" content="闲着无聊随便出了几道题玩玩()">
<meta property="og:locale" content="zh_CN">
<meta property="article:published_time" content="2024-11-27T14:51:24.000Z">
<meta property="article:modified_time" content="2024-11-28T09:06:35.590Z">
<meta property="article:author" content="languag3">
<meta property="article:tag" content="My challenge">
<meta name="twitter:card" content="summary">


<link rel="canonical" href="https://languag3.github.io/2024/11/27/%E8%9C%80%E9%81%93%E5%B1%B1%E9%AB%98%E6%A0%A1%E5%85%AC%E7%9B%8A%E8%81%94%E8%B5%9B/">


<script class="next-config" data-name="page" type="application/json">{"sidebar":"","isHome":false,"isPost":true,"lang":"zh-CN","comments":true,"permalink":"https://languag3.github.io/2024/11/27/%E8%9C%80%E9%81%93%E5%B1%B1%E9%AB%98%E6%A0%A1%E5%85%AC%E7%9B%8A%E8%81%94%E8%B5%9B/","path":"2024/11/27/蜀道山高校公益联赛/","title":"蜀道山高校公益联赛"}</script>

<script class="next-config" data-name="calendar" type="application/json">""</script>
<title>蜀道山高校公益联赛 | languag3</title>
  








  <noscript>
    <link rel="stylesheet" href="/css/noscript.css">
  </noscript>
<!-- hexo injector head_end start -->
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.12.0/dist/katex.min.css">

<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/hexo-math@4.0.0/dist/style.css">
<!-- hexo injector head_end end --></head>

<body itemscope itemtype="http://schema.org/WebPage" class="use-motion">
  <div class="headband"></div>

  <main class="main">
    <div class="column">
      <header class="header" itemscope itemtype="http://schema.org/WPHeader"><div class="site-brand-container">
  <div class="site-nav-toggle">
    <div class="toggle" aria-label="切换导航栏" role="button">
        <span class="toggle-line"></span>
        <span class="toggle-line"></span>
        <span class="toggle-line"></span>
    </div>
  </div>

  <div class="site-meta">

    <a href="/" class="brand" rel="start">
      <i class="logo-line"></i>
      <p class="site-title">languag3</p>
      <i class="logo-line"></i>
    </a>
      <p class="site-subtitle" itemprop="description">众里寻他千百度。蓦然回首，那人却在，灯火阑珊处。</p>
  </div>

  <div class="site-nav-right">
    <div class="toggle popup-trigger" aria-label="搜索" role="button">
    </div>
  </div>
</div>



<nav class="site-nav">
  <ul class="main-menu menu"><li class="menu-item menu-item-home"><a href="/" rel="section"><i class="fa fa-home fa-fw"></i>首页</a></li><li class="menu-item menu-item-about"><a href="/about/" rel="section"><i class="fa fa-user fa-fw"></i>关于</a></li><li class="menu-item menu-item-tags"><a href="/tags/" rel="section"><i class="fa fa-tags fa-fw"></i>标签</a></li><li class="menu-item menu-item-link"><a href="/links/" rel="section"><i class="fa fa-heartbeat fa-fw"></i>友链</a></li><li class="menu-item menu-item-archives"><a href="/archives/" rel="section"><i class="fa fa-archive fa-fw"></i>归档</a></li>
  </ul>
</nav>




</header>
        
  
  <aside class="sidebar">

    <div class="sidebar-inner sidebar-nav-active sidebar-toc-active">
      <ul class="sidebar-nav">
        <li class="sidebar-nav-toc">
          文章目录
        </li>
        <li class="sidebar-nav-overview">
          站点概览
        </li>
      </ul>

      <div class="sidebar-panel-container">
        <!--noindex-->
        <div class="post-toc-wrap sidebar-panel">
            <div class="post-toc animated"><ol class="nav"><li class="nav-item nav-level-1"><a class="nav-link" href="#crypto"><span class="nav-number">1.</span> <span class="nav-text"> CRYPTO</span></a><ol class="nav-child"><li class="nav-item nav-level-2"><a class="nav-link" href="#something-like-coppersmith"><span class="nav-number">1.1.</span> <span class="nav-text"> Something like coppersmith</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#prng_lfsr"><span class="nav-number">1.2.</span> <span class="nav-text"> prng_lfsr</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#algebra"><span class="nav-number">1.3.</span> <span class="nav-text"> algebra</span></a></li></ol></li><li class="nav-item nav-level-1"><a class="nav-link" href="#misc"><span class="nav-number">2.</span> <span class="nav-text"> MISC</span></a><ol class="nav-child"><li class="nav-item nav-level-2"><a class="nav-link" href="#golf"><span class="nav-number">2.1.</span> <span class="nav-text"> golf</span></a></li></ol></li></ol></div>
        </div>
        <!--/noindex-->

        <div class="site-overview-wrap sidebar-panel">
          <div class="site-author animated" itemprop="author" itemscope itemtype="http://schema.org/Person">
    <img class="site-author-image" itemprop="image" alt="languag3"
      src="/images/avatar.jpg">
  <p class="site-author-name" itemprop="name">languag3</p>
  <div class="site-description" itemprop="description"></div>
</div>
<div class="site-state-wrap animated">
  <nav class="site-state">
      <div class="site-state-item site-state-posts">
        <a href="/archives/">
          <span class="site-state-item-count">4</span>
          <span class="site-state-item-name">日志</span>
        </a>
      </div>
      <div class="site-state-item site-state-tags">
          <a href="/tags/">
        <span class="site-state-item-count">2</span>
        <span class="site-state-item-name">标签</span></a>
      </div>
  </nav>
</div>
  <div class="links-of-author animated">
      <span class="links-of-author-item">
        <a href="https://github.com/languag3" title="GitHub → https:&#x2F;&#x2F;github.com&#x2F;languag3" rel="noopener me" target="_blank"><i class="fab fa-github fa-fw"></i>GitHub</a>
      </span>
      <span class="links-of-author-item">
        <a href="mailto:1499304232@qq.com" title="E-Mail → mailto:1499304232@qq.com" rel="noopener me" target="_blank"><i class="fa fa-envelope fa-fw"></i>E-Mail</a>
      </span>
  </div>

        </div>
      </div>
    </div>

    
  </aside>


    </div>

    <div class="main-inner post posts-expand">


  


<div class="post-block">
  
  

  <article itemscope itemtype="http://schema.org/Article" class="post-content" lang="zh-CN">
    <link itemprop="mainEntityOfPage" href="https://languag3.github.io/2024/11/27/%E8%9C%80%E9%81%93%E5%B1%B1%E9%AB%98%E6%A0%A1%E5%85%AC%E7%9B%8A%E8%81%94%E8%B5%9B/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.jpg">
      <meta itemprop="name" content="languag3">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="languag3">
      <meta itemprop="description" content="">
    </span>

    <span hidden itemprop="post" itemscope itemtype="http://schema.org/CreativeWork">
      <meta itemprop="name" content="蜀道山高校公益联赛 | languag3">
      <meta itemprop="description" content="">
    </span>
      <header class="post-header">
        <h1 class="post-title" itemprop="name headline">
          蜀道山高校公益联赛
        </h1>

        <div class="post-meta-container">
          <div class="post-meta">
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar"></i>
      </span>
      <span class="post-meta-item-text">发表于</span>

      <time title="创建时间：2024-11-27 22:51:24" itemprop="dateCreated datePublished" datetime="2024-11-27T22:51:24+08:00">2024-11-27</time>
    </span>
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar-check"></i>
      </span>
      <span class="post-meta-item-text">更新于</span>
      <time title="修改时间：2024-11-28 17:06:35" itemprop="dateModified" datetime="2024-11-28T17:06:35+08:00">2024-11-28</time>
    </span>

  
</div>

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody"><p>闲着无聊随便出了几道题玩玩()</p>
<span id="more"></span> 
<h1 id="crypto"><a class="markdownIt-Anchor" href="#crypto"></a> CRYPTO</h1>
<h2 id="something-like-coppersmith"><a class="markdownIt-Anchor" href="#something-like-coppersmith"></a> Something like coppersmith</h2>
<p>题目</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">from</span> Crypto.Cipher <span class="keyword">import</span> AES</span><br><span class="line"><span class="keyword">from</span> Crypto.Util.Padding <span class="keyword">import</span> pad</span><br><span class="line"><span class="keyword">import</span> hashlib</span><br><span class="line"><span class="keyword">from</span> secret <span class="keyword">import</span> flag</span><br><span class="line"></span><br><span class="line">p = <span class="number">6302810904265501037924401786295397288170843149817176985522767895582968290551414928308932200691953758726228011793524154509586354502691822110981490737900239</span></span><br><span class="line">g = <span class="number">37</span></span><br><span class="line">x = getRandomRange(<span class="number">1</span>, p)</span><br><span class="line">key = hashlib.md5(<span class="built_in">str</span>(x).encode()).digest()</span><br><span class="line">aes = AES.new(key=key, mode=AES.MODE_ECB)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">f&quot;y = <span class="subst">&#123;<span class="built_in">pow</span>(g, x, p)&#125;</span>&quot;</span>)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">f&quot;xl = <span class="subst">&#123;x &amp; (<span class="number">2</span>**<span class="number">404</span> - <span class="number">1</span>)&#125;</span>&quot;</span>)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">f&quot;enc = <span class="subst">&#123;aes.encrypt(pad(flag, <span class="number">16</span>))&#125;</span>&quot;</span>)</span><br><span class="line"><span class="string">&quot;&quot;&quot;</span></span><br><span class="line"><span class="string">y = 1293150376161556844462084321627758417728307246932113125521569554783424543983527961886280946944216834324374477189528743754550041489359187752209421536046860</span></span><br><span class="line"><span class="string">xl = 17986330879434951085449288256517884655391850545705434564933459034981508996937405053663301303792832616366656593647019909376   </span></span><br><span class="line"><span class="string">enc = b&#x27;\x08[\x94\xc1\xc2\xc3\xb9&quot;C^\xd6P\xf9\x0c\xbb\r\r\xaf&amp;\x94\x8cm\x02s\x87\x8b\x1c\xb3\x92\x81H\xe7\xc6\x190a\xca\x91j\xc0@(\xc5Fw\x95\r\xee&#x27;</span></span><br><span class="line"><span class="string">&quot;&quot;&quot;</span></span><br></pre></td></tr></table></figure>
<p>比赛前看的时候p的阶的分解在<a target="_blank" rel="noopener" href="http://factordb.com/">http://factordb.com/</a> 都是不完全的，结果后面一看全给分解完了(不知道是不是谁花钱去分解了)</p>
<p>预期是pohlig_hellman+bsgs，但是都有分解了就可以pohlig_hellman之后爆破就好了难度也大大降低了</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">import</span> gmpy2</span><br><span class="line"><span class="keyword">import</span> functools</span><br><span class="line"><span class="keyword">from</span> Crypto.Cipher <span class="keyword">import</span> AES</span><br><span class="line"><span class="keyword">from</span> tqdm <span class="keyword">import</span> trange</span><br><span class="line"><span class="keyword">import</span> hashlib</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">CRT</span>(<span class="params">mi, ai</span>):</span><br><span class="line">    <span class="keyword">assert</span> functools.reduce(gmpy2.gcd, mi) == <span class="number">1</span></span><br><span class="line">    <span class="keyword">assert</span> <span class="built_in">isinstance</span>(mi, <span class="built_in">list</span>) <span class="keyword">and</span> <span class="built_in">isinstance</span>(ai, <span class="built_in">list</span>)</span><br><span class="line">    M = functools.reduce(<span class="keyword">lambda</span> x, y: x * y, mi)</span><br><span class="line">    ai_ti_Mi = [a * (M // m) * gmpy2.invert(M // m, m) <span class="keyword">for</span> (m, a) <span class="keyword">in</span> <span class="built_in">zip</span>(mi, ai)]</span><br><span class="line">    <span class="keyword">return</span> functools.reduce(<span class="keyword">lambda</span> x, y: x + y, ai_ti_Mi) % M</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">babystep_giantstep</span>(<span class="params">g, y, p, q=<span class="literal">None</span></span>):</span><br><span class="line">    <span class="keyword">if</span> q <span class="keyword">is</span> <span class="literal">None</span>:</span><br><span class="line">        q = p - <span class="number">1</span></span><br><span class="line">    m = <span class="built_in">int</span>(q**<span class="number">0.5</span> + <span class="number">0.5</span>)</span><br><span class="line">    table = &#123;&#125;</span><br><span class="line">    gr = <span class="number">1</span></span><br><span class="line">    <span class="keyword">for</span> r <span class="keyword">in</span> <span class="built_in">range</span>(m):</span><br><span class="line">        table[gr] = r</span><br><span class="line">        gr = (gr * g) % p</span><br><span class="line">    <span class="keyword">try</span>:</span><br><span class="line">        gm = <span class="built_in">pow</span>(g, -m, p)</span><br><span class="line">    <span class="keyword">except</span>:</span><br><span class="line">        <span class="keyword">return</span> <span class="literal">None</span></span><br><span class="line">    ygqm = y</span><br><span class="line">    <span class="keyword">for</span> q <span class="keyword">in</span> <span class="built_in">range</span>(m):</span><br><span class="line">        <span class="keyword">if</span> ygqm <span class="keyword">in</span> table:</span><br><span class="line">            <span class="keyword">return</span> q * m + table[ygqm]</span><br><span class="line">        ygqm = (ygqm * gm) % p</span><br><span class="line">    <span class="keyword">return</span> <span class="literal">None</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">pohlig_hellman_DLP</span>(<span class="params">g, y, p, fac</span>):</span><br><span class="line">    crt_moduli = []</span><br><span class="line">    crt_remain = []</span><br><span class="line">    <span class="keyword">for</span> q <span class="keyword">in</span> fac:</span><br><span class="line">        x = babystep_giantstep(<span class="built_in">pow</span>(g, (p - <span class="number">1</span>) // q, p), <span class="built_in">pow</span>(y, (p - <span class="number">1</span>) // q, p), p, q)</span><br><span class="line">        <span class="keyword">if</span> (x <span class="keyword">is</span> <span class="literal">None</span>) <span class="keyword">or</span> (x &lt;= <span class="number">1</span>):</span><br><span class="line">            <span class="keyword">continue</span></span><br><span class="line">        crt_moduli.append(q)</span><br><span class="line">        crt_remain.append(x)</span><br><span class="line">    x = CRT(crt_moduli, crt_remain)</span><br><span class="line">    <span class="keyword">return</span> x</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">p = <span class="number">6302810904265501037924401786295397288170843149817176985522767895582968290551414928308932200691953758726228011793524154509586354502691822110981490737900239</span></span><br><span class="line">fac = [<span class="number">2</span>, <span class="number">385057</span>, <span class="number">727646221919</span>]</span><br><span class="line">f = <span class="number">385057</span> * <span class="number">727646221919</span></span><br><span class="line">g = <span class="number">37</span></span><br><span class="line">y = <span class="number">1293150376161556844462084321627758417728307246932113125521569554783424543983527961886280946944216834324374477189528743754550041489359187752209421536046860</span></span><br><span class="line">xl = <span class="number">17986330879434951085449288256517884655391850545705434564933459034981508996937405053663301303792832616366656593647019909376</span></span><br><span class="line">enc = <span class="string">b&#x27;\x08[\x94\xc1\xc2\xc3\xb9&quot;C^\xd6P\xf9\x0c\xbb\r\r\xaf&amp;\x94\x8cm\x02s\x87\x8b\x1c\xb3\x92\x81H\xe7\xc6\x190a\xca\x91j\xc0@(\xc5Fw\x95\r\xee&#x27;</span></span><br><span class="line">t = y * inverse(<span class="built_in">pow</span>(g, xl, p), p) % p</span><br><span class="line">d = inverse(<span class="number">2</span>**<span class="number">404</span>, (p - <span class="number">1</span>) // <span class="number">2</span>)</span><br><span class="line">td = <span class="built_in">pow</span>(t, d, p)</span><br><span class="line">xs = pohlig_hellman_DLP(g, td, p, fac)</span><br><span class="line">tdx = td * inverse(<span class="built_in">pow</span>(g, xs, p), p) % p</span><br><span class="line">dic = &#123;&#125;</span><br><span class="line"><span class="keyword">for</span> k1 <span class="keyword">in</span> trange(<span class="number">3</span>, <span class="number">2</span>**<span class="number">24</span>):</span><br><span class="line">    <span class="keyword">if</span> gmpy2.gcd(k1, p-<span class="number">1</span>) == <span class="number">1</span>:</span><br><span class="line">        dic[<span class="built_in">int</span>(gmpy2.powmod(tdx, gmpy2.invert(k1, p - <span class="number">1</span>), p))] = k1</span><br><span class="line">    <span class="keyword">else</span>:</span><br><span class="line">        dic[<span class="built_in">int</span>(gmpy2.powmod(tdx, gmpy2.invert(k1, (p - <span class="number">1</span>) // gmpy2.gcd(k1, p-<span class="number">1</span>)), p))] = k1</span><br><span class="line"><span class="keyword">for</span> k2 <span class="keyword">in</span> trange(<span class="number">2</span>**<span class="number">25</span>):</span><br><span class="line">    aa = <span class="built_in">int</span>(gmpy2.powmod(g, k2 * f, p))</span><br><span class="line">    <span class="keyword">if</span> aa <span class="keyword">in</span> dic:</span><br><span class="line">        k1 = dic[aa]</span><br><span class="line">        <span class="built_in">print</span>(k1, k2)</span><br><span class="line">        <span class="keyword">break</span></span><br><span class="line">xh = xs + k1 * k2 * f</span><br><span class="line">x = xh * <span class="number">2</span>**<span class="number">404</span> + xl</span><br><span class="line">key = hashlib.md5(<span class="built_in">str</span>(x).encode()).digest()</span><br><span class="line">aes = AES.new(key=key, mode=AES.MODE_ECB)</span><br><span class="line"><span class="built_in">print</span>(aes.decrypt(enc))</span><br><span class="line"><span class="comment"># LZSDS&#123;m@N_Wh@t_c@n_I_5@y_____dfa015cdc546&#125;</span></span><br></pre></td></tr></table></figure>
<h2 id="prng_lfsr"><a class="markdownIt-Anchor" href="#prng_lfsr"></a> prng_lfsr</h2>
<p>题目</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> os</span><br><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">import</span> hashlib</span><br><span class="line"><span class="keyword">from</span> secret <span class="keyword">import</span> flag</span><br><span class="line"></span><br><span class="line"><span class="keyword">assert</span> hashlib.sha256(flag).hexdigest() == <span class="string">&quot;1b6208006b19ceddc493a8fe1342c1c7bba1800b2a66b9da4cd819f8440f331f&quot;</span></span><br><span class="line"><span class="keyword">assert</span> <span class="built_in">len</span>(flag) == <span class="number">40</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">LFSR</span>:</span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">__init__</span>(<span class="params">self, n, key, mask</span>):</span><br><span class="line">        <span class="variable language_">self</span>.state = key</span><br><span class="line">        <span class="variable language_">self</span>.mask = mask</span><br><span class="line">        <span class="variable language_">self</span>.n = n</span><br><span class="line">        <span class="variable language_">self</span>.state = [<span class="built_in">int</span>(b) <span class="keyword">for</span> b <span class="keyword">in</span> <span class="built_in">bin</span>(<span class="variable language_">self</span>.state)[<span class="number">2</span>:].zfill(n)]</span><br><span class="line">        <span class="variable language_">self</span>.mask_bits = [<span class="built_in">int</span>(b) <span class="keyword">for</span> b <span class="keyword">in</span> <span class="built_in">bin</span>(<span class="variable language_">self</span>.mask)[<span class="number">2</span>:].zfill(n)]</span><br><span class="line"></span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">update</span>(<span class="params">self</span>):</span><br><span class="line">        s = <span class="built_in">sum</span>([<span class="variable language_">self</span>.state[i] * <span class="variable language_">self</span>.mask_bits[i] <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="variable language_">self</span>.n)]) &amp; <span class="number">1</span></span><br><span class="line">        <span class="variable language_">self</span>.state = <span class="variable language_">self</span>.state[<span class="number">1</span>:] + [s]</span><br><span class="line"></span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">__call__</span>(<span class="params">self</span>):</span><br><span class="line">        <span class="variable language_">self</span>.update()</span><br><span class="line">        b = <span class="variable language_">self</span>.state[-<span class="number">1</span>]</span><br><span class="line">        <span class="keyword">return</span> b</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">LCG</span>:</span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">__init__</span>(<span class="params">self, seed</span>):</span><br><span class="line">        <span class="variable language_">self</span>.seed = seed</span><br><span class="line">        <span class="variable language_">self</span>.a = <span class="number">47026247687942121848144207491837523525</span></span><br><span class="line">        <span class="variable language_">self</span>.b = <span class="number">117397592171526113268558934119004209487</span></span><br><span class="line">        <span class="variable language_">self</span>.m = <span class="number">2</span>**<span class="number">128</span></span><br><span class="line"></span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">next</span>(<span class="params">self</span>):</span><br><span class="line">        <span class="variable language_">self</span>.seed = (<span class="variable language_">self</span>.seed * <span class="variable language_">self</span>.a + <span class="variable language_">self</span>.b) % <span class="variable language_">self</span>.m</span><br><span class="line">        <span class="keyword">return</span> (<span class="variable language_">self</span>.seed &gt;&gt; <span class="number">64</span>) ^ (<span class="variable language_">self</span>.seed % <span class="number">2</span>**<span class="number">64</span>)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">f</span>(<span class="params">alist, seed</span>):</span><br><span class="line">    R = LCG(seed)</span><br><span class="line">    l = <span class="built_in">len</span>(alist)</span><br><span class="line">    res = <span class="number">0</span></span><br><span class="line">    <span class="keyword">for</span> _ <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">30</span>):</span><br><span class="line">        index = R.<span class="built_in">next</span>() % l</span><br><span class="line">        res ^= alist[index]</span><br><span class="line">        res &amp;= alist[(index + <span class="number">1</span>) % l]</span><br><span class="line">        res |= alist[(index - <span class="number">1</span>) % l]</span><br><span class="line">    <span class="keyword">return</span> res</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">pad</span>(<span class="params">m</span>):</span><br><span class="line">    <span class="keyword">return</span> m * <span class="number">25</span> + os.urandom(<span class="number">2000</span> - <span class="built_in">len</span>(m) * <span class="number">25</span>)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">XOR = <span class="keyword">lambda</span> s1, s2: <span class="built_in">bytes</span>([x1 ^ x2 <span class="keyword">for</span> x1, x2 <span class="keyword">in</span> <span class="built_in">zip</span>(s1, s2)])</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">seed = getRandomRange(<span class="number">1</span>, <span class="number">2</span>**<span class="number">128</span>)</span><br><span class="line">R = LCG(seed)</span><br><span class="line">bit = <span class="number">64</span></span><br><span class="line">t = <span class="number">8</span></span><br><span class="line">mask = [R.<span class="built_in">next</span>() <span class="keyword">for</span> _ <span class="keyword">in</span> <span class="built_in">range</span>(t)]</span><br><span class="line">seed = [getRandomNBitInteger(bit) <span class="keyword">for</span> _ <span class="keyword">in</span> <span class="built_in">range</span>(t)]</span><br><span class="line">lfsr = [LFSR(bit, seed[i], mask[i]) <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(t)]</span><br><span class="line">output = <span class="number">0</span></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">2000</span> * <span class="number">8</span>):</span><br><span class="line">    output &lt;&lt;= <span class="number">1</span></span><br><span class="line">    output += f([lfsr[i]() <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(t)], seed)</span><br><span class="line">flag = pad(flag)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">f&quot;mask = <span class="subst">&#123;mask[-<span class="number">4</span>:]&#125;</span>&quot;</span>)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">f&quot;enc = <span class="subst">&#123;XOR(flag, long_to_bytes(output))&#125;</span>&quot;</span>)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">f&quot;hint = <span class="subst">&#123;flag[-<span class="number">100</span>:]&#125;</span>&quot;</span>)</span><br><span class="line"><span class="string">&quot;&quot;&quot;</span></span><br><span class="line"><span class="string">mask = [14220691401612821285, 6144765487634854340, 15963296602901011718, 11570958398098493701]</span></span><br><span class="line"><span class="string">enc = b&#x27;\xfa\xb2G\xb0\xccYU\x16\t\xbe)\xdc\x19\x1f\x16x\x98D\xdf+\x95\x0b\xeeL\xca\x07[\x1fM\x04T\xd3V\x11\x19\xe3\x8a\x8f\\\xfflda\x7f/B\xae\x85E!\xc4\x17M\xd7\xd3\x9e\xbc\xb2\xfc\x97\xe1W\x83\xdd\xdcR\xcfh\xd0\xd4D\xc5\x949M\xa1\xff\xe1\x9fd\x89\xa85\xff\x85&#123;;:\x9e\x91G\x11o\xc4%\xe9\xb2\x1e\x8e\x9as\xbb&lt;\xbb8z\xae\x15\xac\xea&quot;x:\x81\xe7\xda\xd1\x8fv\xd7\x92\x85\x953AH\xd7CAkBU-\x97\xce\xe0\x11\xbe\xa7\xc6\x7f\x1d\xedgL\xc7B\xfa\x82P\xf1\xeb\xd6#B\xdd\xce=\xae\xaf\x92&#125;A\xed\x99\xec\xa3k\xff|r\xec9d\xa3\x17\x92\xd2\r[o*\x8e\x95\x1b\xecj\xf8\xb2WF\x01\x05ia^\x7f\xa1n\xab\x12\x84\xddo\xd5\x82\xdeJ\xde\xaeX\x83\xd4\xaa\xc3\xbb:\x92\xce\x15\x85f\x06F\xc5\x04\x0c&gt;\xa7\xca^\xf0\x01\x1dG\x12\xbc|\xa5_\x8c\xa3\xb6\x8dj$\xd1\xbet\x8c\x05\x0f\xcc\x01\xf4\n\xeb\xcdb(+\xcf\xc8\x99\x9b\xd0\x0c1\x9c\xa0s\xf3\x93/\xabU&#123;;jbC\xd4\xfa\x92\x83\xcd\x8cb8\xb4\x80\xed\x0600~\x1f\xa8\x1a8\xc42\xd4\xdb\x07+\xa1M\xf6 E\xb1+\xa2R\x81\x91\xd8\xb4\x15&amp;\xbc\xa0\xbd\x87&lt;\xb5\x8d\x9f\x9e\xb1\xb6\xea\xf2\x99w|C^\xa3\xc36BZ\xe1\xe6R|\x18\x9f\xcd\xc3`\x86\n\x13^\x95\x82\xc0P\x11l\x0fY\xd3\x9a\xcc\xef\xd9\x8d]\xa1&quot;&#125;\x89\xd1\x98\t\xc8\xa9/\x1f\xcb\xae\xe9\x936\xd8\x9d\x8d\xed\xb6\xe7d\xe4\xd2\x12\x84\x0cx\x15\xa0K\xc6\t\x1a\x10\xcc\x92\xf3\x95r\xe1\x89\xec\x0eE\x8f\xf9i\x1b\x0b\xa3\xc0I\x99\x81\x05[\x86\xba\xbd\xd9\x16^\x86\xd9\xbc\x86\xe1&#123;\xcd6j\x93\x9d\xe2\xf2\x121&lt;7x\xb1\xb6j\x8cG+\xf2\x0e6\x02Y\xe1\xc8\xa1\x14=Y\xaaUMJ\xec$\xda\xe4N\xd5\xe1i\x03\xe5\xd0w\xb9\xdf|A\xb0\xe4\xa9\xcao\x06[\xc1\x1e~\x1c\x9dx\x97\xbcVoD\xfd\x80\x1b\x96\x1e=\xb7\xf8)\xbe\xbaQ\xbb]\x17\x86\xd18\x18?\x0e\x03\x1f-\xf5\xe0\xe0\xa1\xfbBB$\x0f\xa6\x84O5\x962\xb0\xf1\xb8K\x0c\x83\x15p_\xde\xe6\x05\xb0\xff\x8f\xd2\x7f\xba\xea\x80V\xda\r2j\xd0G\x95?\x18G\xf6\xb5\xc05\xa6\xed\xcd%)\x0f!\xf2\x95\xd7L\x17PX\x07:\x8c\xbb_4\xc9\xef\rw\xda\xdf1\xa5\x805&#123;\x0c\xe0s\x15\xc0/\x83?\xb48\xc1\x0c\xdaW\xddJ\x8d\x8e\x9f\xacx\x11\xf5H\x91\x8b\xec\xcc\xa7\xee\x81\xdf\xdfuBV\x98\xcd&#125;\xcf\xa2\xe5\xf8\xac\xa3\xff\x1d\x90;\xe3\x1dQ\xe4\xaaI\xb0\x9f\xc4\x1d^\xca\x91\xdb\xaf\xfc\xa0\xaa\xc7\x8d\xaa\xe0\xd3\x98\x9c\xba\x9a\xc2\xfb\x96&#125;\xf5\xf3F\xc1\x0e\x9d\xe9i@L\x82\x9c\x9a&#123;\xf0\xe7\xc0yb\x1f,\x92\x81\xa0\x96\xe7\x16o`\x1fQ\xf5\x7f[\x18n\x83]\xdd\xb1Zl\t\xf3\x8f\xd3)J\xaaW\x87\xbf~\x0c\xddX\xad\x10\xfe&#125;DW[\x15\x9a\x81Z\xf0\x9b#\xcd\xc5\xbb\x9c\xad\x86\xc5\xa9,\&#x27;-\x0c\xf5w\xd1\x93\xdc\xacKT\xa1\x85\xf6lF\x92l2PI\xdb\xcd\x16\x9a\x1f\xd4\x1d0\n\xb7\x14 \x95\xc7&#123;\&#x27;B\xa0\xb8:\xb6\xbe\xc0\xf8\x8a\xe8&lt;O\xaf\xc9FI\xfb\xfd\xf6\xf3v\xac\xea\xd6\xb4spk\xe1\xaa\xe3(\xaa\xd3q\xe5\xca\x9c\xc0R\xb8\xddk6P\xe71\xc2\x8dH\x9b\x0c\x85\xf6z\x1c\x88V\x88\xd2N&#125;\x8a:\x1d/%j\x10\x82j\x141\x01\x9a\xbbr\xa1\x9c8\xb0\xea\xd5\xb67\xef\xc2\x171\xe8!p\x93\x05\x18\x9e\xb3\x07@\x1cY\x9f\xb9\x13\xf3~5\x9d\x10\xa2q\xf9\xf0)%\xbcZ8*\x86\xe4\x12D&lt;\xd3c\x94s\xe4\xc1yr\x02\xc06a\xea\xc7\xc0\xc0\xa1\x8d\x05&quot;] \x127X\xf5\x9bn~\xf6\x85\x93\xf1W\xbc\x94%\xc0\rt\xee6C\xa2\xd6\xf3\xcc\t\xc5\xe8\x8cV,\xb2A;\x9e\xd3\x9c\x1c\xc4\xffE\xec\x15\xb0E\xfb\x18\xab8;\xfa\x00\x84\xf5=\xf6\xd2\tu/\xc1\x8aW\xbb&#123;\xdc\x98\x9e\xecS\xdcOPKq/\x9c\x86\x15h\x0b\x00\xea\x94\xe5\xb4\xe5ip4\x8e8&#123;`\x81\xd9\xee\x19`9\xbf47\x1f\xb5\x05\xe6\xc7\xb9I\x1bM^\xd9\x83\x00\xb4\x0b3\\~\x04;\x1d\xf8\xe0&#125;q\xf4\x94\xad/@b\xde@\xd0\xb7bR\xb84\x9a3\x0f\xba\x90\xd0\x8e\xa0\x022 \xca\xe2\x89\x07qE+#~\xfb&lt;\x90O\x04\xbc\xdb\x7f\t&lt;$\x87\xcf\xc8\xe5\xb7\\\x81\x07\xae\xc7\x84\xbb\xdbV\x17\xc5\xfb\x1a\xe0L\xe9A\xbcy\xc8\xc5\xf7\r&gt;a\x9c\xbc\xad\x18,\xf8\x8ch\xf7\xd6\xb0\xc0\x1e\xbb&#125;\xffr\xae\xcf\xae!\xc7\\\xc6\xd8\xbf\x81\xef\x04\xd9awf\xda\&#x27;vh\xeb\xd5\xac\x1c\xe5)PJ\x9f\x02\x1f\xba\x03\xc0\x073\xb8K\xe6A\xc8t\xabjA\xbd\xff\x9e\x81\xfa@\x86H\xa8\xb8\xf5\xbb\xc4\xb9\xe8\x9f \x14\xbcL\x08r\xca\xc8\xfe\xf6k\x18;\xdf\xd6)#\x02X&amp;\x0e|\x03\x85H\xc4\x0c\x81G\x04P\x05h\xaeI*\xd0\x88&amp;|\xf8\x02&gt;\xe1I\x80cF z\xf0yL\x10%\xd1\xa7Wb\x064\xf8\x05[eBwp\x15\xa4c`\x8aL\xba\xb4\xd1\x9c\xce\xd4\xb8\xd0\x18\xf3?b^,\xed\xb8_\x8fp\xa07\xbb\xba \x08\x9c\xf1\xac\x03\xe8\xd5\x05\x83\xf1\xbb\x1c\xcd\x9aF\xc7\x10\xa8\xd9\xdf\x05\xee\xca&lt;\xf4)\x82\xa7\xe8C9\x0c~6\x8e&#123;\xf3\x80\x0c\xbe\x13 \xf6\xfa\x7f\xec\x08\x929\x92\xcd\xd4GT\xbde\xda\x9fSk\xf6\r\x00W\r&#125;\x99(IG\xd5\x0c\xd0\xdcj&#123;r|\x81\t\x9f\x8f\x1f\x0ee^\xcb*&lt;\xbb\x993\x8f\x07\xc2\xa1`\xe2W&gt;\x84c\x00\xa7a\xe2\xdb\xbd\xe2\xb7\x87/2ugj:[\xdd\xa8\x8c\xcc\xe5\xde\xbd\xe39UW\xcc\x9b\xc7\xbb\x88H\xdb N\xeb\xa8xo\x84)\xc2\xa0$\xfe\x90T\xb9rxNDT\x13\xb7\x97\x81^g\xbdU\x89\xfd\x89r\x03U\xf7\x07\xe2gd\x0e\xe5O\xb6,\xcf\xb5+\x00\xca\x93@\rK\xfe=\xca\xbb\x12\x83\x9a)\xfd\xda\xd1\xa95\x9eyw\xaa\xb8^`2wWF\xf3\x7f\xb0b\x83\xa4\&#x27;@%f\x8f\xa5J\x1frA\xfb\xb6p\xaf\xe1\x8d\xba\xb2\xff\x9a\xeb\x14%\x10\x89,\xc6\xa2&gt;\xf9m\xb2T\xee\xb4\x98\x04\xde\xf3%o\xd7\x80P\x08\xc2\x00^a\xa3\xe4\xadZ\x90\xad\xc6\xb2\xbd\x04^\x13^\x82\x12\x14\x96\xce+0/\x92U\xfc\xf6A[\xdd\xc3\x8cr\xa8l\x1a\x95\x03Wm\xdeD!\\\xc9\x98\xd3\xea\x90\x8bR\xfe\xf2\x10+\xe1\x8f\xde\x18\xe1\xbb\x0bh\x1c\x0e\xdb\x1ea\xc6\\?\xd2\x8b\xc4c\x84\x7f\x9a_\xe2\xd2\xc84\xaej\x85\x10\x10\xc7d,8\x0b\x89^\x18\x8f\xd6G\xa1p\x83n\xb7^\x14\xcd\x18\x8b\xe6\x9d\x00s\xcb\x02\xc1\xee&lt;\xa2F\xb4\xa99]+\x0b\x1a\xed\xdae\xe3\xd3\x82\x19\x02\x80k-\xc8\xa7\x9c\x9d\x92\xc8\xefr\&#x27;\xfds\x9a\xa5\xe8\xd4\tS\xb0\xa0\xbd*\xfc=\xf6\xd4e\xb3\x80\x8c\x0e\xb9_]\xd6\xc2d\xa6\x19\xd5\x90\x0b\x9e3\xb3\xf1\xee\xb0w\xce\xa3&amp;\xd0\xae\xaa+C\x05\xb2 \xf5\xccf\x90\x1d\xb3$\xe5\xbc\x07\xe0\xb4\xc8\xb6~\x00\x9e\x84Z\xf9\xb7\xe1\xdaB=i\x9d\x19\xa4oJ,\xe7\xe4 \&#x27;#f\x91vB\xf8\xe2\x0e9\x84\xe7\xf1\xde\xd0+\xa2\x11\x96.\xfd\x8c\xba[jEAM&lt;\x03\x12U\x84\xab&#123;2\x81H\x066\x01\\\x96\x99\xfa\x19\xd0\xb2\xe5\xf9\xb6,+\x97)\xb7h\xd2@\xda\x89_\xd6S\x8f@%q\xb5$\xc7\x89\xb7\xe2\xf8\xb1\xa5\xc8|\x83\xce\xe7\x88\xb8\xb1\xdd\xa5J\xcar\xcd\x8f\xfe\t\x85\xd0\xb4FC#(\x85-\xf6fm5\xecUWE \xd4\x0b&#125;\xc0\x9d\x1c\x14\x83\xfc^5\ng\x7f\x13\xfe&#123;[\x8b\xbc?\xc2+\xfb\xa8O\x8b\xf6e\x91vG\xffd\xdf\x0c\x84Ig&amp;\x1b\xbb\xcb\x84;\x94\x13\\\xcc\x178\xa1\xbd\x08.&#x27;</span></span><br><span class="line"><span class="string">hint = b&#x27;\x93+\xc6\\$s\x16Sp\xf24\x91wPg&lt;BS=\x9e\xe4\xce\xdb\xa3N\xe6\xe1/\x17\xfa`9\x8f\xe33\x92\x80\xa6@\xd6P\xb0\xdb\x8eJmD\xf1\x10Y^c4\xd0\x86N\x8an0\xf4\xe3\x8b\xbd\xdff\xb6%H\xd3\x85\xf3`\xbc\n\x02\xa21_\x82U\xa7\t,\xaf\x9e\x9cn\x88\x92\xadi\xab\x19@Wa\xe6\x1e\xf9\x9e&#x27;</span></span><br><span class="line"><span class="string">&quot;&quot;&quot;</span></span><br></pre></td></tr></table></figure>
<p>思路很简单，先通过恢复LCG的seed来得到nfsr的所有mask，然后通过攻击nfsr来恢复flag</p>
<p>这个LCG和普通的不一样的地方在于它是把高位和低位异或了之后才进行输出</p>
<p>但是如果我们爆破它的输出的低位的话，可以拿到它的中位，然后可以看成一个hnp问题来打</p>
<p>恢复出mask后我们考察nfsr的相关性其实发现和lfsr2相关性很高</p>
<p>那很简单了，我们只要恢复出lfsr2的seed(我是通过代数免疫度来攻击的，其实也可以别的)，然后其输出大概率和nfsr的相同，那我们直接用它的输出和密文异或，然后统计一下即可得到flag</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br><span class="line">170</span><br><span class="line">171</span><br><span class="line">172</span><br><span class="line">173</span><br><span class="line">174</span><br><span class="line">175</span><br><span class="line">176</span><br><span class="line">177</span><br><span class="line">178</span><br><span class="line">179</span><br><span class="line">180</span><br><span class="line">181</span><br><span class="line">182</span><br><span class="line">183</span><br><span class="line">184</span><br><span class="line">185</span><br><span class="line">186</span><br><span class="line">187</span><br><span class="line">188</span><br><span class="line">189</span><br><span class="line">190</span><br><span class="line">191</span><br><span class="line">192</span><br><span class="line">193</span><br><span class="line">194</span><br><span class="line">195</span><br><span class="line">196</span><br><span class="line">197</span><br><span class="line">198</span><br><span class="line">199</span><br><span class="line">200</span><br><span class="line">201</span><br><span class="line">202</span><br><span class="line">203</span><br><span class="line">204</span><br><span class="line">205</span><br><span class="line">206</span><br><span class="line">207</span><br><span class="line">208</span><br><span class="line">209</span><br><span class="line">210</span><br><span class="line">211</span><br><span class="line">212</span><br><span class="line">213</span><br><span class="line">214</span><br><span class="line">215</span><br><span class="line">216</span><br><span class="line">217</span><br><span class="line">218</span><br><span class="line">219</span><br><span class="line">220</span><br><span class="line">221</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">import</span> hashlib</span><br><span class="line"><span class="keyword">from</span> tqdm <span class="keyword">import</span> trange</span><br><span class="line"></span><br><span class="line">masks = [<span class="number">14220691401612821285</span>, <span class="number">6144765487634854340</span>, <span class="number">15963296602901011718</span>, <span class="number">11570958398098493701</span>]</span><br><span class="line">enc = <span class="string">b&#x27;\xfa\xb2G\xb0\xccYU\x16\t\xbe)\xdc\x19\x1f\x16x\x98D\xdf+\x95\x0b\xeeL\xca\x07[\x1fM\x04T\xd3V\x11\x19\xe3\x8a\x8f\\\xfflda\x7f/B\xae\x85E!\xc4\x17M\xd7\xd3\x9e\xbc\xb2\xfc\x97\xe1W\x83\xdd\xdcR\xcfh\xd0\xd4D\xc5\x949M\xa1\xff\xe1\x9fd\x89\xa85\xff\x85&#123;;:\x9e\x91G\x11o\xc4%\xe9\xb2\x1e\x8e\x9as\xbb&lt;\xbb8z\xae\x15\xac\xea&quot;x:\x81\xe7\xda\xd1\x8fv\xd7\x92\x85\x953AH\xd7CAkBU-\x97\xce\xe0\x11\xbe\xa7\xc6\x7f\x1d\xedgL\xc7B\xfa\x82P\xf1\xeb\xd6#B\xdd\xce=\xae\xaf\x92&#125;A\xed\x99\xec\xa3k\xff|r\xec9d\xa3\x17\x92\xd2\r[o*\x8e\x95\x1b\xecj\xf8\xb2WF\x01\x05ia^\x7f\xa1n\xab\x12\x84\xddo\xd5\x82\xdeJ\xde\xaeX\x83\xd4\xaa\xc3\xbb:\x92\xce\x15\x85f\x06F\xc5\x04\x0c&gt;\xa7\xca^\xf0\x01\x1dG\x12\xbc|\xa5_\x8c\xa3\xb6\x8dj$\xd1\xbet\x8c\x05\x0f\xcc\x01\xf4\n\xeb\xcdb(+\xcf\xc8\x99\x9b\xd0\x0c1\x9c\xa0s\xf3\x93/\xabU&#123;;jbC\xd4\xfa\x92\x83\xcd\x8cb8\xb4\x80\xed\x0600~\x1f\xa8\x1a8\xc42\xd4\xdb\x07+\xa1M\xf6 E\xb1+\xa2R\x81\x91\xd8\xb4\x15&amp;\xbc\xa0\xbd\x87&lt;\xb5\x8d\x9f\x9e\xb1\xb6\xea\xf2\x99w|C^\xa3\xc36BZ\xe1\xe6R|\x18\x9f\xcd\xc3`\x86\n\x13^\x95\x82\xc0P\x11l\x0fY\xd3\x9a\xcc\xef\xd9\x8d]\xa1&quot;&#125;\x89\xd1\x98\t\xc8\xa9/\x1f\xcb\xae\xe9\x936\xd8\x9d\x8d\xed\xb6\xe7d\xe4\xd2\x12\x84\x0cx\x15\xa0K\xc6\t\x1a\x10\xcc\x92\xf3\x95r\xe1\x89\xec\x0eE\x8f\xf9i\x1b\x0b\xa3\xc0I\x99\x81\x05[\x86\xba\xbd\xd9\x16^\x86\xd9\xbc\x86\xe1&#123;\xcd6j\x93\x9d\xe2\xf2\x121&lt;7x\xb1\xb6j\x8cG+\xf2\x0e6\x02Y\xe1\xc8\xa1\x14=Y\xaaUMJ\xec$\xda\xe4N\xd5\xe1i\x03\xe5\xd0w\xb9\xdf|A\xb0\xe4\xa9\xcao\x06[\xc1\x1e~\x1c\x9dx\x97\xbcVoD\xfd\x80\x1b\x96\x1e=\xb7\xf8)\xbe\xbaQ\xbb]\x17\x86\xd18\x18?\x0e\x03\x1f-\xf5\xe0\xe0\xa1\xfbBB$\x0f\xa6\x84O5\x962\xb0\xf1\xb8K\x0c\x83\x15p_\xde\xe6\x05\xb0\xff\x8f\xd2\x7f\xba\xea\x80V\xda\r2j\xd0G\x95?\x18G\xf6\xb5\xc05\xa6\xed\xcd%)\x0f!\xf2\x95\xd7L\x17PX\x07:\x8c\xbb_4\xc9\xef\rw\xda\xdf1\xa5\x805&#123;\x0c\xe0s\x15\xc0/\x83?\xb48\xc1\x0c\xdaW\xddJ\x8d\x8e\x9f\xacx\x11\xf5H\x91\x8b\xec\xcc\xa7\xee\x81\xdf\xdfuBV\x98\xcd&#125;\xcf\xa2\xe5\xf8\xac\xa3\xff\x1d\x90;\xe3\x1dQ\xe4\xaaI\xb0\x9f\xc4\x1d^\xca\x91\xdb\xaf\xfc\xa0\xaa\xc7\x8d\xaa\xe0\xd3\x98\x9c\xba\x9a\xc2\xfb\x96&#125;\xf5\xf3F\xc1\x0e\x9d\xe9i@L\x82\x9c\x9a&#123;\xf0\xe7\xc0yb\x1f,\x92\x81\xa0\x96\xe7\x16o`\x1fQ\xf5\x7f[\x18n\x83]\xdd\xb1Zl\t\xf3\x8f\xd3)J\xaaW\x87\xbf~\x0c\xddX\xad\x10\xfe&#125;DW[\x15\x9a\x81Z\xf0\x9b#\xcd\xc5\xbb\x9c\xad\x86\xc5\xa9,\&#x27;-\x0c\xf5w\xd1\x93\xdc\xacKT\xa1\x85\xf6lF\x92l2PI\xdb\xcd\x16\x9a\x1f\xd4\x1d0\n\xb7\x14 \x95\xc7&#123;\&#x27;B\xa0\xb8:\xb6\xbe\xc0\xf8\x8a\xe8&lt;O\xaf\xc9FI\xfb\xfd\xf6\xf3v\xac\xea\xd6\xb4spk\xe1\xaa\xe3(\xaa\xd3q\xe5\xca\x9c\xc0R\xb8\xddk6P\xe71\xc2\x8dH\x9b\x0c\x85\xf6z\x1c\x88V\x88\xd2N&#125;\x8a:\x1d/%j\x10\x82j\x141\x01\x9a\xbbr\xa1\x9c8\xb0\xea\xd5\xb67\xef\xc2\x171\xe8!p\x93\x05\x18\x9e\xb3\x07@\x1cY\x9f\xb9\x13\xf3~5\x9d\x10\xa2q\xf9\xf0)%\xbcZ8*\x86\xe4\x12D&lt;\xd3c\x94s\xe4\xc1yr\x02\xc06a\xea\xc7\xc0\xc0\xa1\x8d\x05&quot;] \x127X\xf5\x9bn~\xf6\x85\x93\xf1W\xbc\x94%\xc0\rt\xee6C\xa2\xd6\xf3\xcc\t\xc5\xe8\x8cV,\xb2A;\x9e\xd3\x9c\x1c\xc4\xffE\xec\x15\xb0E\xfb\x18\xab8;\xfa\x00\x84\xf5=\xf6\xd2\tu/\xc1\x8aW\xbb&#123;\xdc\x98\x9e\xecS\xdcOPKq/\x9c\x86\x15h\x0b\x00\xea\x94\xe5\xb4\xe5ip4\x8e8&#123;`\x81\xd9\xee\x19`9\xbf47\x1f\xb5\x05\xe6\xc7\xb9I\x1bM^\xd9\x83\x00\xb4\x0b3\\~\x04;\x1d\xf8\xe0&#125;q\xf4\x94\xad/@b\xde@\xd0\xb7bR\xb84\x9a3\x0f\xba\x90\xd0\x8e\xa0\x022 \xca\xe2\x89\x07qE+#~\xfb&lt;\x90O\x04\xbc\xdb\x7f\t&lt;$\x87\xcf\xc8\xe5\xb7\\\x81\x07\xae\xc7\x84\xbb\xdbV\x17\xc5\xfb\x1a\xe0L\xe9A\xbcy\xc8\xc5\xf7\r&gt;a\x9c\xbc\xad\x18,\xf8\x8ch\xf7\xd6\xb0\xc0\x1e\xbb&#125;\xffr\xae\xcf\xae!\xc7\\\xc6\xd8\xbf\x81\xef\x04\xd9awf\xda\&#x27;vh\xeb\xd5\xac\x1c\xe5)PJ\x9f\x02\x1f\xba\x03\xc0\x073\xb8K\xe6A\xc8t\xabjA\xbd\xff\x9e\x81\xfa@\x86H\xa8\xb8\xf5\xbb\xc4\xb9\xe8\x9f \x14\xbcL\x08r\xca\xc8\xfe\xf6k\x18;\xdf\xd6)#\x02X&amp;\x0e|\x03\x85H\xc4\x0c\x81G\x04P\x05h\xaeI*\xd0\x88&amp;|\xf8\x02&gt;\xe1I\x80cF z\xf0yL\x10%\xd1\xa7Wb\x064\xf8\x05[eBwp\x15\xa4c`\x8aL\xba\xb4\xd1\x9c\xce\xd4\xb8\xd0\x18\xf3?b^,\xed\xb8_\x8fp\xa07\xbb\xba \x08\x9c\xf1\xac\x03\xe8\xd5\x05\x83\xf1\xbb\x1c\xcd\x9aF\xc7\x10\xa8\xd9\xdf\x05\xee\xca&lt;\xf4)\x82\xa7\xe8C9\x0c~6\x8e&#123;\xf3\x80\x0c\xbe\x13 \xf6\xfa\x7f\xec\x08\x929\x92\xcd\xd4GT\xbde\xda\x9fSk\xf6\r\x00W\r&#125;\x99(IG\xd5\x0c\xd0\xdcj&#123;r|\x81\t\x9f\x8f\x1f\x0ee^\xcb*&lt;\xbb\x993\x8f\x07\xc2\xa1`\xe2W&gt;\x84c\x00\xa7a\xe2\xdb\xbd\xe2\xb7\x87/2ugj:[\xdd\xa8\x8c\xcc\xe5\xde\xbd\xe39UW\xcc\x9b\xc7\xbb\x88H\xdb N\xeb\xa8xo\x84)\xc2\xa0$\xfe\x90T\xb9rxNDT\x13\xb7\x97\x81^g\xbdU\x89\xfd\x89r\x03U\xf7\x07\xe2gd\x0e\xe5O\xb6,\xcf\xb5+\x00\xca\x93@\rK\xfe=\xca\xbb\x12\x83\x9a)\xfd\xda\xd1\xa95\x9eyw\xaa\xb8^`2wWF\xf3\x7f\xb0b\x83\xa4\&#x27;@%f\x8f\xa5J\x1frA\xfb\xb6p\xaf\xe1\x8d\xba\xb2\xff\x9a\xeb\x14%\x10\x89,\xc6\xa2&gt;\xf9m\xb2T\xee\xb4\x98\x04\xde\xf3%o\xd7\x80P\x08\xc2\x00^a\xa3\xe4\xadZ\x90\xad\xc6\xb2\xbd\x04^\x13^\x82\x12\x14\x96\xce+0/\x92U\xfc\xf6A[\xdd\xc3\x8cr\xa8l\x1a\x95\x03Wm\xdeD!\\\xc9\x98\xd3\xea\x90\x8bR\xfe\xf2\x10+\xe1\x8f\xde\x18\xe1\xbb\x0bh\x1c\x0e\xdb\x1ea\xc6\\?\xd2\x8b\xc4c\x84\x7f\x9a_\xe2\xd2\xc84\xaej\x85\x10\x10\xc7d,8\x0b\x89^\x18\x8f\xd6G\xa1p\x83n\xb7^\x14\xcd\x18\x8b\xe6\x9d\x00s\xcb\x02\xc1\xee&lt;\xa2F\xb4\xa99]+\x0b\x1a\xed\xdae\xe3\xd3\x82\x19\x02\x80k-\xc8\xa7\x9c\x9d\x92\xc8\xefr\&#x27;\xfds\x9a\xa5\xe8\xd4\tS\xb0\xa0\xbd*\xfc=\xf6\xd4e\xb3\x80\x8c\x0e\xb9_]\xd6\xc2d\xa6\x19\xd5\x90\x0b\x9e3\xb3\xf1\xee\xb0w\xce\xa3&amp;\xd0\xae\xaa+C\x05\xb2 \xf5\xccf\x90\x1d\xb3$\xe5\xbc\x07\xe0\xb4\xc8\xb6~\x00\x9e\x84Z\xf9\xb7\xe1\xdaB=i\x9d\x19\xa4oJ,\xe7\xe4 \&#x27;#f\x91vB\xf8\xe2\x0e9\x84\xe7\xf1\xde\xd0+\xa2\x11\x96.\xfd\x8c\xba[jEAM&lt;\x03\x12U\x84\xab&#123;2\x81H\x066\x01\\\x96\x99\xfa\x19\xd0\xb2\xe5\xf9\xb6,+\x97)\xb7h\xd2@\xda\x89_\xd6S\x8f@%q\xb5$\xc7\x89\xb7\xe2\xf8\xb1\xa5\xc8|\x83\xce\xe7\x88\xb8\xb1\xdd\xa5J\xcar\xcd\x8f\xfe\t\x85\xd0\xb4FC#(\x85-\xf6fm5\xecUWE \xd4\x0b&#125;\xc0\x9d\x1c\x14\x83\xfc^5\ng\x7f\x13\xfe&#123;[\x8b\xbc?\xc2+\xfb\xa8O\x8b\xf6e\x91vG\xffd\xdf\x0c\x84Ig&amp;\x1b\xbb\xcb\x84;\x94\x13\\\xcc\x178\xa1\xbd\x08.&#x27;</span></span><br><span class="line">hint = <span class="string">b&#x27;\x93+\xc6\\$s\x16Sp\xf24\x91wPg&lt;BS=\x9e\xe4\xce\xdb\xa3N\xe6\xe1/\x17\xfa`9\x8f\xe33\x92\x80\xa6@\xd6P\xb0\xdb\x8eJmD\xf1\x10Y^c4\xd0\x86N\x8an0\xf4\xe3\x8b\xbd\xdff\xb6%H\xd3\x85\xf3`\xbc\n\x02\xa21_\x82U\xa7\t,\xaf\x9e\x9cn\x88\x92\xadi\xab\x19@Wa\xe6\x1e\xf9\x9e&#x27;</span></span><br><span class="line"></span><br><span class="line">X = masks</span><br><span class="line">a = <span class="number">47026247687942121848144207491837523525</span></span><br><span class="line">b = <span class="number">117397592171526113268558934119004209487</span></span><br><span class="line">mod = <span class="number">2</span> ** <span class="number">128</span></span><br><span class="line">l = <span class="number">17</span></span><br><span class="line"></span><br><span class="line">n = <span class="built_in">len</span>(X)</span><br><span class="line">AA = [a]</span><br><span class="line">BB = [b]</span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(n):</span><br><span class="line">    AA.append(a * AA[-<span class="number">1</span>])</span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(n):</span><br><span class="line">    BB.append(a * BB[-<span class="number">1</span>] + b)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> w <span class="keyword">in</span> trange(<span class="number">2</span>**l):</span><br><span class="line">    R.&lt;Th0,Th1,Th2,Th3,Tl0,Tl1,Tl2,Tl3&gt;=Zmod(mod)[]</span><br><span class="line"></span><br><span class="line">    Tl = [w]</span><br><span class="line">    Tm = [w ^^ X[<span class="number">0</span>] &amp; (<span class="number">2</span>**l - <span class="number">1</span>)]</span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="built_in">len</span>(X) - <span class="number">1</span>):</span><br><span class="line">        k = (a ** (i + <span class="number">1</span>) * w + b * (a ** (i + <span class="number">1</span>) - <span class="number">1</span>) // (a - <span class="number">1</span>)) &amp; (<span class="number">2</span>**l - <span class="number">1</span>)</span><br><span class="line">        Tl.append(k)</span><br><span class="line">        Tm.append(k ^^ X[i + <span class="number">1</span>] &amp; (<span class="number">2</span>**l - <span class="number">1</span>))</span><br><span class="line">    n = <span class="built_in">len</span>(Tm)</span><br><span class="line">    A = [a]</span><br><span class="line">    B = [b]</span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(n):</span><br><span class="line">        A.append(a * A[-<span class="number">1</span>])</span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(n):</span><br><span class="line">        B.append(a * B[-<span class="number">1</span>] + b)</span><br><span class="line"></span><br><span class="line">    ff = []</span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(n-<span class="number">1</span>):</span><br><span class="line">        ff.append((<span class="number">2</span>**(<span class="number">64</span>+l)*Th0+<span class="number">2</span>**<span class="number">64</span>*Tm[<span class="number">0</span>]+<span class="number">2</span>**l*Tl0+Tl[<span class="number">0</span>])*A[i+<span class="number">1</span>]-B[<span class="number">0</span>]*A[i+<span class="number">1</span>]-(<span class="number">2</span>**(<span class="number">64</span>+l)*<span class="built_in">eval</span>(<span class="string">f&#x27;Th<span class="subst">&#123;i+<span class="number">1</span>&#125;</span>&#x27;</span>)+<span class="number">2</span>**<span class="number">64</span>*Tm[i+<span class="number">1</span>]+<span class="number">2</span>**l*<span class="built_in">eval</span>(<span class="string">f&#x27;Tl<span class="subst">&#123;i+<span class="number">1</span>&#125;</span>&#x27;</span>)+Tl[i+<span class="number">1</span>])*A[<span class="number">0</span>]+B[i+<span class="number">1</span>]*A[<span class="number">0</span>])</span><br><span class="line"></span><br><span class="line">    T = <span class="number">2</span>**(<span class="number">64</span>-l)</span><br><span class="line"></span><br><span class="line">    deg_h = <span class="built_in">sum</span>(ff).degree()</span><br><span class="line">    polys = ff</span><br><span class="line"></span><br><span class="line">    M, v = <span class="type">Sequence</span>(polys).coefficient_matrix()</span><br><span class="line">    M = M.T.dense_matrix()</span><br><span class="line">    R, C = M.dimensions()</span><br><span class="line">    B = block_matrix(</span><br><span class="line">        ZZ, [[matrix.identity(C)*mod, matrix.zero(C, R)], [M, matrix.identity(R)]]</span><br><span class="line">    )</span><br><span class="line">    vT = (v.T).<span class="built_in">list</span>()</span><br><span class="line"></span><br><span class="line">    B[:,:C] *= mod</span><br><span class="line">    <span class="keyword">for</span> jj <span class="keyword">in</span> <span class="built_in">range</span>(<span class="built_in">len</span>(vT)):</span><br><span class="line">        B[:,C+jj:C+jj+<span class="number">1</span>] *= T^(deg_h-vT[jj].degree())</span><br><span class="line"></span><br><span class="line">    res = B.BKZ()</span><br><span class="line">    <span class="keyword">for</span> tt <span class="keyword">in</span> res:</span><br><span class="line">        trunc = []</span><br><span class="line">        <span class="keyword">if</span>(<span class="built_in">abs</span>(tt[-<span class="number">1</span>]) == T^deg_h):</span><br><span class="line">            f=[<span class="built_in">abs</span>(tt[-i-<span class="number">2</span>])//T^(deg_h-<span class="number">1</span>) <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(n)][::-<span class="number">1</span>]</span><br><span class="line">            ml = [<span class="number">2</span>**l*f[i]+Tl[i] <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="built_in">len</span>(f))]</span><br><span class="line">            <span class="keyword">break</span></span><br><span class="line">    mh = [ml[i]^^X[i] <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="built_in">len</span>(ml))]</span><br><span class="line"></span><br><span class="line">    m = [ml[i]+<span class="number">2</span>**<span class="number">64</span>*mh[i] <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="built_in">len</span>(ml))]</span><br><span class="line">    seed=m[<span class="number">0</span>]</span><br><span class="line">    <span class="keyword">if</span> (a*seed+b)%mod ==m[<span class="number">1</span>]:</span><br><span class="line">        <span class="built_in">print</span>(seed)</span><br><span class="line">        <span class="comment"># 92831300514842470778050206073212376504</span></span><br><span class="line">        <span class="keyword">break</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">5</span>):</span><br><span class="line">    seed = (seed - b)*inverse(a,mod)%mod</span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span>(seed)</span><br><span class="line"><span class="comment"># 262310659054038114087383397436792734657</span></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">LCG</span>:</span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">__init__</span>(<span class="params">self, seed</span>):</span><br><span class="line">        <span class="variable language_">self</span>.seed = seed</span><br><span class="line">        <span class="variable language_">self</span>.a = <span class="number">47026247687942121848144207491837523525</span></span><br><span class="line">        <span class="variable language_">self</span>.b = <span class="number">117397592171526113268558934119004209487</span></span><br><span class="line">        <span class="variable language_">self</span>.m = <span class="number">2</span>**<span class="number">128</span></span><br><span class="line"></span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">next</span>(<span class="params">self</span>):</span><br><span class="line">        <span class="variable language_">self</span>.seed = (<span class="variable language_">self</span>.seed * <span class="variable language_">self</span>.a + <span class="variable language_">self</span>.b) % <span class="variable language_">self</span>.m</span><br><span class="line">        <span class="keyword">return</span> (<span class="variable language_">self</span>.seed &gt;&gt; <span class="number">64</span>) ^^ (<span class="variable language_">self</span>.seed % <span class="number">2</span>**<span class="number">64</span>)</span><br><span class="line"></span><br><span class="line">R = LCG(seed)</span><br><span class="line">masks = [R.<span class="built_in">next</span>() <span class="keyword">for</span> _ <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">8</span>)]</span><br><span class="line"></span><br><span class="line">XOR = <span class="keyword">lambda</span> s1, s2: <span class="built_in">bytes</span>([x1 ^^ x2 <span class="keyword">for</span> x1, x2 <span class="keyword">in</span> <span class="built_in">zip</span>(s1, s2)])</span><br><span class="line"></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">LFSRSymbolic</span>:</span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">__init__</span>(<span class="params">self, n, key, mask</span>):</span><br><span class="line">        <span class="variable language_">self</span>.state = key</span><br><span class="line">        <span class="variable language_">self</span>.mask = mask</span><br><span class="line">        <span class="variable language_">self</span>.n = n</span><br><span class="line">        <span class="variable language_">self</span>.mask_bits = [<span class="built_in">int</span>(b) <span class="keyword">for</span> b <span class="keyword">in</span> <span class="built_in">bin</span>(<span class="variable language_">self</span>.mask)[<span class="number">2</span>:].zfill(n)]</span><br><span class="line"></span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">update</span>(<span class="params">self</span>):</span><br><span class="line">        s = <span class="built_in">sum</span>([<span class="variable language_">self</span>.state[i] * <span class="variable language_">self</span>.mask_bits[i] <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="variable language_">self</span>.n)])</span><br><span class="line">        <span class="variable language_">self</span>.state = <span class="variable language_">self</span>.state[<span class="number">1</span>:] + [s]</span><br><span class="line"></span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">__call__</span>(<span class="params">self</span>):</span><br><span class="line">        <span class="variable language_">self</span>.update()</span><br><span class="line">        b = <span class="variable language_">self</span>.state[-<span class="number">1</span>]</span><br><span class="line">        <span class="keyword">return</span> b</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">ff</span>(<span class="params">alist</span>):</span><br><span class="line">    R = LCG(seed)</span><br><span class="line">    l = <span class="built_in">len</span>(alist)</span><br><span class="line">    res = <span class="number">0</span></span><br><span class="line">    <span class="keyword">for</span> _ <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">30</span>):</span><br><span class="line">        index = R.<span class="built_in">next</span>() % l</span><br><span class="line">        res ^^= alist[index]</span><br><span class="line">        res &amp;= alist[(index + <span class="number">1</span>) % l]</span><br><span class="line">        res |= alist[(index - <span class="number">1</span>) % l]</span><br><span class="line">    <span class="keyword">return</span> res</span><br><span class="line"></span><br><span class="line">out = XOR(enc[-<span class="number">100</span>:], hint)</span><br><span class="line">out = bytes_to_long(out)</span><br><span class="line"><span class="keyword">from</span> itertools <span class="keyword">import</span> product</span><br><span class="line"><span class="keyword">from</span> sage.crypto.boolean_function <span class="keyword">import</span> *</span><br><span class="line"></span><br><span class="line">table = []</span><br><span class="line"><span class="keyword">for</span> x7, x6, x5, x4, x3, x2, x1, x0 <span class="keyword">in</span> product([<span class="number">0</span>, <span class="number">1</span>], repeat=<span class="number">8</span>):</span><br><span class="line">    x = [x0, x1, x2, x3, x4, x5, x6, x7]</span><br><span class="line">    table.append(ff(x))</span><br><span class="line">f = BooleanFunction(table)</span><br><span class="line">fp = f.algebraic_normal_form()</span><br><span class="line">_, g = f.algebraic_immunity(annihilator=<span class="literal">True</span>)</span><br><span class="line"><span class="built_in">print</span>(g)</span><br><span class="line">bin_out = <span class="built_in">bin</span>(out)[<span class="number">2</span>:]</span><br><span class="line">mask=masks[<span class="number">1</span>]</span><br><span class="line">br64 = BooleanPolynomialRing(<span class="number">64</span>, [<span class="string">f&quot;x<span class="subst">&#123;i&#125;</span>&quot;</span> <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">64</span>)])</span><br><span class="line">key_sym = <span class="built_in">list</span>(br64.gens())</span><br><span class="line">lfsr3 = LFSRSymbolic(<span class="number">64</span>, key_sym, mask)</span><br><span class="line"><span class="keyword">from</span> tqdm <span class="keyword">import</span> trange</span><br><span class="line">x3=[]</span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> trange(<span class="number">2000</span>*<span class="number">8</span>):</span><br><span class="line">    x3.append(lfsr3())</span><br><span class="line">x3=x3[-<span class="number">800</span>:]</span><br><span class="line"></span><br><span class="line">eqs=[]</span><br><span class="line"><span class="keyword">for</span> i, bit <span class="keyword">in</span> <span class="built_in">enumerate</span>(bin_out):</span><br><span class="line">    <span class="keyword">if</span> bit==<span class="string">&#x27;0&#x27;</span>:</span><br><span class="line">        eqs.append(x3[i])</span><br><span class="line">m = []</span><br><span class="line">B = []</span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> eqs:</span><br><span class="line">    s = []</span><br><span class="line">    <span class="keyword">for</span> x <span class="keyword">in</span> <span class="built_in">range</span>(<span class="built_in">len</span>(key_sym)):</span><br><span class="line">        <span class="keyword">if</span> key_sym[x] <span class="keyword">in</span> i:</span><br><span class="line">            s.append(<span class="number">1</span>)</span><br><span class="line">        <span class="keyword">else</span>:</span><br><span class="line">            s.append(<span class="number">0</span>)</span><br><span class="line">    <span class="keyword">if</span> <span class="string">&quot;+ 1&quot;</span> <span class="keyword">in</span> <span class="built_in">str</span>(i):</span><br><span class="line">        B.append(<span class="number">1</span>)</span><br><span class="line">    <span class="keyword">else</span>:</span><br><span class="line">        B.append(<span class="number">0</span>)</span><br><span class="line">    m.append(s)</span><br><span class="line">m = matrix(GF(<span class="number">2</span>), m)</span><br><span class="line">B = vector(GF(<span class="number">2</span>), B)</span><br><span class="line">seed3=m.right_kernel()[<span class="number">2</span>]</span><br><span class="line">seed3=<span class="built_in">int</span>(<span class="string">&#x27;&#x27;</span>.join(<span class="built_in">map</span>(<span class="built_in">str</span>, seed3)),<span class="number">2</span>)</span><br><span class="line"></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">LFSR</span>:</span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">__init__</span>(<span class="params">self, n, key, mask</span>):</span><br><span class="line">        <span class="variable language_">self</span>.state = [<span class="built_in">int</span>(b) <span class="keyword">for</span> b <span class="keyword">in</span> <span class="built_in">bin</span>(key)[<span class="number">2</span>:].zfill(n)]</span><br><span class="line">        <span class="variable language_">self</span>.mask = mask</span><br><span class="line">        <span class="variable language_">self</span>.n = n</span><br><span class="line">        <span class="variable language_">self</span>.mask_bits = [<span class="built_in">int</span>(b) <span class="keyword">for</span> b <span class="keyword">in</span> <span class="built_in">bin</span>(<span class="variable language_">self</span>.mask)[<span class="number">2</span>:].zfill(n)]</span><br><span class="line"></span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">update</span>(<span class="params">self</span>):</span><br><span class="line">        s = <span class="built_in">sum</span>([<span class="variable language_">self</span>.state[i] * <span class="variable language_">self</span>.mask_bits[i] <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="variable language_">self</span>.n)]) &amp; <span class="number">1</span></span><br><span class="line">        <span class="variable language_">self</span>.state = <span class="variable language_">self</span>.state[<span class="number">1</span>:] + [s]</span><br><span class="line"></span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">__call__</span>(<span class="params">self</span>):</span><br><span class="line">        <span class="variable language_">self</span>.update()</span><br><span class="line">        b = <span class="variable language_">self</span>.state[-<span class="number">1</span>]</span><br><span class="line">        <span class="keyword">return</span> b</span><br><span class="line">    </span><br><span class="line">lfsr = LFSR(<span class="number">64</span>,seed3,mask)</span><br><span class="line">output=<span class="number">0</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">2000</span>*<span class="number">8</span>):</span><br><span class="line">    output&lt;&lt;=<span class="number">1</span></span><br><span class="line">    output +=lfsr()</span><br><span class="line">enc_=bytes_to_long(enc)</span><br><span class="line">mm=long_to_bytes(enc_^^output)</span><br><span class="line">mmm=mm[:<span class="number">1000</span>]</span><br><span class="line">ou=[<span class="number">0</span> <span class="keyword">for</span> _ <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">320</span>)]</span><br><span class="line">ji=[<span class="number">0</span> <span class="keyword">for</span> _ <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">320</span>)]</span><br><span class="line">c=<span class="built_in">bin</span>(bytes_to_long(mmm))[<span class="number">2</span>:].zfill(<span class="number">8000</span>)</span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">25</span>):</span><br><span class="line">    t=c[i*<span class="number">320</span>:i*<span class="number">320</span>+<span class="number">320</span>]</span><br><span class="line">    <span class="keyword">for</span> j <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">320</span>):</span><br><span class="line">        <span class="keyword">if</span>(t[j]==<span class="string">&#x27;1&#x27;</span>):</span><br><span class="line">            ji[j]+=<span class="number">1</span></span><br><span class="line">        <span class="keyword">else</span>:</span><br><span class="line">            ou[j]+=<span class="number">1</span></span><br><span class="line">flag=<span class="string">&#x27;&#x27;</span></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">320</span>):</span><br><span class="line">    <span class="keyword">if</span>(ji[i]&gt;ou[i]):</span><br><span class="line">        flag+=<span class="string">&#x27;1&#x27;</span></span><br><span class="line">    <span class="keyword">elif</span>(ji[i]==ou[i]):</span><br><span class="line">        <span class="built_in">print</span>(i)</span><br><span class="line">    <span class="keyword">else</span>:</span><br><span class="line">        flag+=<span class="string">&#x27;0&#x27;</span></span><br><span class="line">flag=long_to_bytes(<span class="built_in">int</span>(flag,<span class="number">2</span>))</span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">256</span>):</span><br><span class="line">    f=flag[:-<span class="number">6</span>]+long_to_bytes(i)+flag[-<span class="number">5</span>:]</span><br><span class="line">    <span class="keyword">if</span>(hashlib.sha256(f).hexdigest()==<span class="string">&#x27;1b6208006b19ceddc493a8fe1342c1c7bba1800b2a66b9da4cd819f8440f331f&#x27;</span>):</span><br><span class="line">        <span class="built_in">print</span>(f)</span><br><span class="line"><span class="comment"># LZSDS&#123;d41d8c2d98f00b204e9800998ecf8427e&#125;</span></span><br></pre></td></tr></table></figure>
<h2 id="algebra"><a class="markdownIt-Anchor" href="#algebra"></a> algebra</h2>
<p>题目</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> sage.<span class="built_in">all</span> <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">from</span> Crypto.Cipher <span class="keyword">import</span> AES</span><br><span class="line"><span class="keyword">from</span> Crypto.Util.Padding <span class="keyword">import</span> pad</span><br><span class="line"><span class="keyword">from</span> hashlib <span class="keyword">import</span> md5</span><br><span class="line"><span class="keyword">from</span> secret <span class="keyword">import</span> flag</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">algebra</span>(<span class="title class_ inherited__">CommutativeRingElement</span>):</span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">__init__</span>(<span class="params">self, parent, a1, a2, c=<span class="literal">None</span></span>):</span><br><span class="line">        CommutativeRingElement.__init__(<span class="variable language_">self</span>, parent)</span><br><span class="line">        <span class="variable language_">self</span>.a1 = a1</span><br><span class="line">        <span class="variable language_">self</span>.a2 = a2</span><br><span class="line">        <span class="variable language_">self</span>.c = c</span><br><span class="line"></span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">__add__</span>(<span class="params">self, other</span>):</span><br><span class="line">        <span class="keyword">return</span> algebra(</span><br><span class="line">            <span class="variable language_">self</span>.parent(), <span class="built_in">max</span>(<span class="variable language_">self</span>.a1, other.a1), <span class="built_in">max</span>(<span class="variable language_">self</span>.a2, other.a2), c=<span class="variable language_">self</span>.c</span><br><span class="line">        )</span><br><span class="line"></span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">__mul__</span>(<span class="params">self, other</span>):</span><br><span class="line">        p = <span class="number">0</span></span><br><span class="line">        <span class="keyword">if</span> <span class="variable language_">self</span>.c <span class="keyword">is</span> <span class="keyword">not</span> <span class="literal">None</span>:</span><br><span class="line">            p += <span class="variable language_">self</span>.c</span><br><span class="line">        first = <span class="built_in">max</span>(p + <span class="variable language_">self</span>.a1 + other.a1, p + <span class="variable language_">self</span>.a2 + other.a2)</span><br><span class="line">        second = <span class="built_in">max</span>(p + <span class="variable language_">self</span>.a1 + other.a2, p + <span class="variable language_">self</span>.a2 + other.a1)</span><br><span class="line">        <span class="keyword">return</span> algebra(<span class="variable language_">self</span>.parent(), first, second, c=<span class="variable language_">self</span>.c)</span><br><span class="line"></span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">__eq__</span>(<span class="params">self, other</span>):</span><br><span class="line">        <span class="keyword">return</span> (<span class="variable language_">self</span>.a1 == other.a1) <span class="keyword">and</span> (<span class="variable language_">self</span>.a2 == other.a2)</span><br><span class="line"></span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">__ne__</span>(<span class="params">self, other</span>):</span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">not</span> <span class="variable language_">self</span>.__eq__(other)</span><br><span class="line"></span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">__repr__</span>(<span class="params">self</span>):</span><br><span class="line">        <span class="keyword">return</span> <span class="string">f&quot;T(<span class="subst">&#123;self.a1&#125;</span>, <span class="subst">&#123;self.a2&#125;</span>)&quot;</span></span><br><span class="line"></span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">_mul_</span>(<span class="params">self, other</span>):</span><br><span class="line">        <span class="keyword">return</span> <span class="variable language_">self</span>.__mul__(other)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">algebraring</span>(UniqueRepresentation, Parent):</span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">__init__</span>(<span class="params">self, c=<span class="literal">None</span></span>):</span><br><span class="line">        Parent.__init__(<span class="variable language_">self</span>, category=CommutativeRings())</span><br><span class="line">        <span class="variable language_">self</span>.c = c</span><br><span class="line"></span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">_element_constructor_</span>(<span class="params">self, a1, a2</span>):</span><br><span class="line">        <span class="keyword">return</span> algebra(<span class="variable language_">self</span>, a1, a2, <span class="variable language_">self</span>.c)</span><br><span class="line"></span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">__repr__</span>(<span class="params">self</span>):</span><br><span class="line">        <span class="keyword">return</span> <span class="string">&quot;algebraring&quot;</span></span><br><span class="line"></span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">zero</span>(<span class="params">self</span>):</span><br><span class="line">        <span class="keyword">return</span> <span class="variable language_">self</span>(<span class="built_in">float</span>(<span class="string">&quot;-inf&quot;</span>), <span class="built_in">float</span>(<span class="string">&quot;-inf&quot;</span>))</span><br><span class="line"></span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">random_element</span>(<span class="params">self, lower_bound=-<span class="number">10</span>, upper_bound=<span class="number">10</span></span>):</span><br><span class="line">        <span class="keyword">from</span> random <span class="keyword">import</span> randint</span><br><span class="line"></span><br><span class="line">        a1 = randint(lower_bound, upper_bound)</span><br><span class="line">        a2 = randint(lower_bound, upper_bound)</span><br><span class="line">        <span class="keyword">return</span> <span class="variable language_">self</span>._element_constructor_(a1, a2)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">change_ring</span>(<span class="params">matrix, ring</span>):</span><br><span class="line">    n = <span class="built_in">len</span>(matrix[<span class="number">0</span>, :].<span class="built_in">list</span>())</span><br><span class="line">    new_matrix = [</span><br><span class="line">        [ring(matrix[i, j].a1, matrix[i, j].a2) <span class="keyword">for</span> j <span class="keyword">in</span> <span class="built_in">range</span>(n)] <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(n)</span><br><span class="line">    ]</span><br><span class="line">    <span class="keyword">return</span> Matrix(ring, new_matrix)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">shift</span>(<span class="params">matrix, x</span>):</span><br><span class="line">    n = <span class="built_in">len</span>(matrix[<span class="number">0</span>, :].<span class="built_in">list</span>())</span><br><span class="line">    ring = matrix.base_ring()</span><br><span class="line">    new_matrix = [</span><br><span class="line">        [ring(matrix[i, j].a1 + x, matrix[i, j].a2 + x) <span class="keyword">for</span> j <span class="keyword">in</span> <span class="built_in">range</span>(n)] <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(n)</span><br><span class="line">    ]</span><br><span class="line">    <span class="keyword">return</span> Matrix(ring, new_matrix)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">n = <span class="number">3</span></span><br><span class="line"></span><br><span class="line">c = getRandomNBitInteger(<span class="number">256</span>)</span><br><span class="line">k = getRandomNBitInteger(<span class="number">256</span>)</span><br><span class="line">l = getRandomNBitInteger(<span class="number">256</span>)</span><br><span class="line">p = getRandomNBitInteger(<span class="number">256</span>)</span><br><span class="line"></span><br><span class="line">d = getRandomNBitInteger(<span class="number">256</span>)</span><br><span class="line">r = getRandomNBitInteger(<span class="number">256</span>)</span><br><span class="line">s = getRandomNBitInteger(<span class="number">256</span>)</span><br><span class="line">q = getRandomNBitInteger(<span class="number">256</span>)</span><br><span class="line"></span><br><span class="line">T = algebraring()</span><br><span class="line">TA = algebraring(c)</span><br><span class="line">TB = algebraring(d)</span><br><span class="line"></span><br><span class="line">X = random_matrix(T, n, lower_bound=<span class="number">0</span>, upper_bound=<span class="number">2</span>**<span class="number">256</span>)</span><br><span class="line">Y = random_matrix(T, n, lower_bound=<span class="number">0</span>, upper_bound=<span class="number">2</span>**<span class="number">256</span>)</span><br><span class="line"></span><br><span class="line">XA = change_ring(change_ring(X, TA) ** k, T)</span><br><span class="line">YA = change_ring(change_ring(Y, TA) ** l, T)</span><br><span class="line">A = XA * YA</span><br><span class="line">A_p = shift(A, p)</span><br><span class="line"></span><br><span class="line">XB = change_ring(change_ring(X, TB) ** r, T)</span><br><span class="line">YB = change_ring(change_ring(Y, TB) ** s, T)</span><br><span class="line">B = XB * YB</span><br><span class="line">B_q = shift(B, q)</span><br><span class="line"></span><br><span class="line">KA = shift(XA, p) * B_q * YA</span><br><span class="line">KB = shift(XB, q) * A_p * YB</span><br><span class="line"><span class="keyword">assert</span> KA == KB</span><br><span class="line"></span><br><span class="line">key = md5(<span class="built_in">str</span>(KA).encode()).digest()</span><br><span class="line">aes = AES.new(key=key, mode=AES.MODE_ECB)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">f&quot;enc = <span class="subst">&#123;aes.encrypt(pad(flag, <span class="number">16</span>))&#125;</span>&quot;</span>)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">f&quot;X = <span class="subst">&#123;X.<span class="built_in">list</span>()&#125;</span>&quot;</span>)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">f&quot;Y = <span class="subst">&#123;Y.<span class="built_in">list</span>()&#125;</span>&quot;</span>)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">f&quot;A_p = <span class="subst">&#123;A_p.<span class="built_in">list</span>()&#125;</span>&quot;</span>)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">f&quot;B_q = <span class="subst">&#123;B_q.<span class="built_in">list</span>()&#125;</span>&quot;</span>)</span><br><span class="line"><span class="string">&quot;&quot;&quot;</span></span><br><span class="line"><span class="string">enc = b&#x27;\x88I\xa6\xa5\x83\x8a\xd3$dk/\xf9\xdb\xc7\xec\xe8\xf6\x8c\x9d\xad\xe7\x8d\xb8\xe73~&amp;\xb6O\xe5\x0f\x12\xf3?@\xd4\xc6I\xeel\x9d\xdd8\x92*gY`&#x27;</span></span><br><span class="line"><span class="string">X = [T(59900590664029081588751597115949479657291730864508459758763562295986654520462, 68320552779283515276240499643319977619901440989200422494626425642962224959344), T(89698054093719949422762429034310548012077225043893131168337545047107450749496, 51479199576292239130066082976332639976062899059190752269878695108378488146679), T(62218736027330266192570144338062026977337231944985836220559539768109014406831, 61214354159525954062640070826510640683451706120539795727362849462686622564693), T(39805827211060089460158250456599968341463470401750393132792110953878249393569, 99103416592859133938491410425030428643259368893929508081326035011417306901272), T(20922493031536155240718266043337868355652138270147183521353456319726724009058, 31430964180770964194690164159235543367301572045989047438624310779165592317271), T(8959191626315499956806224120588498434035126032025230565571486221513367178374, 20067214390603904748675229391030612573671604470294660618614875919888930884780), T(66048220278298402781571427858585494416782927078968140383635650050886579125833, 18175597939833315588572188448012546734970985103503074208793106634216584036818), T(14432081053446841732493980558668616443341123394659689880088380115934894274635, 83557493069309650142798328460651561327339732728386566873314215777128303177667), T(34511162979554971448736265846077014796752072453004958739933710734947541396694, 77364571020765493103034943723333754233327577188690990300833856668531817680505)]</span></span><br><span class="line"><span class="string">Y = [T(78533528545456238383274783853785358016819467733594018596743219756487720633746, 93976221569207299395273293543645974643384826524816615562497005292252667770601), T(103766862112463335445955325531890205089005117500922857426350491681602103969000, 47323529900779960229909476477918095608118443655903527805237066535366116839149), T(10190752330406968772077432866677538790850926811710030717810026338836331450472, 86375880251137784911361557173115785351126971447566503084261189167084220453288), T(13780196681979042044702022951434986810164135209191561823725939514845972817610, 55170363535880083300862447306063246181282182639154190917220001586753468629546), T(436029875577652990270691130860178026240806299188121622633421834221330373636, 110804259765120571425960874898903708961853698355143533817410855395636486531982), T(6397911849400997286703265695504239070876241554571709807303889197285939312681, 17360696619752702589750097897661044951586752285334140009669640422948343241568), T(58041034583523761593801980039841494595215125402194920275127841961766699686394, 54766044749028865088458074550257196739016298676359665986238379481142351990626), T(77530103367856397256662107816221151235947660504364282548276904992741575506849, 63854892725980295947169956482257581700294549443273322483764382131671051522332), T(47497441477952935509240863594022229337695084880724507207404445061842628668952, 56713418154978297086219120150091406983389112617302018465360827172758909144570)]</span></span><br><span class="line"><span class="string">A_p = [T(40547797283575399311345964287271714617688023231464400205040285835460999315476731205228816544079212468645004319629302959473711018684702750872290449940972698, 40547797283575399311345964287271714617688023231464400205040285835460999315476698934497596879746169782553959201278357925243089469169482083236651301175074462), T(40547797283575399311345964287271714617688023231464400205040285835460999315476786839125045784567337567072597160092083530989427008027602941726099332958875134, 40547797283575399311345964287271714617688023231464400205040285835460999315476750004263963436463523550691311785519855896914393402679802307379634177780083118), T(40547797283575399311345964287271714617688023231464400205040285835460999315476706776849302561292697869327278531705692232746803441653969601206061897674894004, 40547797283575399311345964287271714617688023231464400205040285835460999315476682432777130064993198309463393760622192553532626436203592834759900982411655833), T(40547797283575399311345964287271714617688023231464400205040285835460999315476733573193663026027748192077028026006061293036706834385224678998540725414561492, 40547797283575399311345964287271714617688023231464400205040285835460999315476709827727502107645065946715613329058910783689656325976029039752886304715182546), T(40547797283575399311345964287271714617688023231464400205040285835460999315476789207089892266515873290504620866468841864552422823728124869852349608432463928, 40547797283575399311345964287271714617688023231464400205040285835460999315476765461623731348133191045143206169521691355205372315318929230606695187733084982), T(40547797283575399311345964287271714617688023231464400205040285835460999315476709144814149043241233592759302238082450566309799257354491529332312173148482798, 40547797283575399311345964287271714617688023231464400205040285835460999315476685399347988124858551347397887541135300056962748748945295890086657752449103852), T(40547797283575399311345964287271714617688023231464400205040285835460999315476692793936572469446889818453385542291673187750773962605187059907381322027502633, 40547797283575399311345964287271714617688023231464400205040285835460999315476725064667792133779932504544430660642618221981395512120407727543020470793400869), T(40547797283575399311345964287271714617688023231464400205040285835460999315476746626235376326170902419020010827637210112057551060804659922530107892689013547, 40547797283575399311345964287271714617688023231464400205040285835460999315476780698564021374268057602972023501105398793497111501463307918396829353811303305), T(40547797283575399311345964287271714617688023231464400205040285835460999315476676292216105654693918345362820101635507816040310929639297811430631003264084004, 40547797283575399311345964287271714617688023231464400205040285835460999315476700636288278150993417905226704872719007495254487935089674577876791918527322175)]</span></span><br><span class="line"><span class="string">B_q = [T(44956584717324859629636950162153871886560739437959809729281253007078755840271381302732123072890496216398568268656559622476770594999251404506445788064037538, 44956584717324859629636950162153871886560739437959809729281253007078755840271413573463342737223538902489613387007504656707392144514472072142084936829935774), T(44956584717324859629636950162153871886560739437959809729281253007078755840271432372498489629607849984535920852898057594148074528509571628649428664669046194, 44956584717324859629636950162153871886560739437959809729281253007078755840271469207359571977711664000917206227470285228223108133857372262995893819847838210), T(44956584717324859629636950162153871886560739437959809729281253007078755840271364801011656258137524743308002828000394250766307562033362156029695469300618909, 44956584717324859629636950162153871886560739437959809729281253007078755840271389145083828754437024303171887599083893929980484567483738922475856384563857080), T(44956584717324859629636950162153871886560739437959809729281253007078755840271392195962028300789392380560222396437112480923337451805798361022680791604145622, 44956584717324859629636950162153871886560739437959809729281253007078755840271415941428189219172074625921637093384262990270387960214994000268335212303524568), T(44956584717324859629636950162153871886560739437959809729281253007078755840271447829858257541277517478987815236899893052439053441148698551876489674622048058, 44956584717324859629636950162153871886560739437959809729281253007078755840271471575324418459660199724349229933847043561786103949557894191122144095321427004), T(44956584717324859629636950162153871886560739437959809729281253007078755840271367767582514318002877781242496608513501754196429874775065211356452239338066928, 44956584717324859629636950162153871886560739437959809729281253007078755840271391513048675236385560026603911305460652263543480383184260850602106660037445874), T(44956584717324859629636950162153871886560739437959809729281253007078755840271407432902318326924258938389039728020819919215076637950177048812814957682363945, 44956584717324859629636950162153871886560739437959809729281253007078755840271375162171098662591216252297994609669874884984455088434956381177175808916465709), T(44956584717324859629636950162153871886560739437959809729281253007078755840271463066798547567412384036816632568483600490730792627293077239666623840700266381, 44956584717324859629636950162153871886560739437959809729281253007078755840271428994469902519315228852864619895015411809291232186634429243799902379577976623), T(44956584717324859629636950162153871886560739437959809729281253007078755840271383004522804344137744339071313940097209192488169060919443899146586405416285251, 44956584717324859629636950162153871886560739437959809729281253007078755840271358660450631847838244779207429169013709513273992055469067132700425490153047080)]</span></span><br><span class="line"><span class="string">&quot;&quot;&quot;</span></span><br></pre></td></tr></table></figure>
<p>参考<a target="_blank" rel="noopener" href="https://eprint.iacr.org/2024/010.pdf">https://eprint.iacr.org/2024/010.pdf</a> 来攻击即可，难度不大，似乎都卡在找这篇论文了 XD</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br><span class="line">170</span><br><span class="line">171</span><br><span class="line">172</span><br><span class="line">173</span><br><span class="line">174</span><br><span class="line">175</span><br><span class="line">176</span><br><span class="line">177</span><br><span class="line">178</span><br><span class="line">179</span><br><span class="line">180</span><br><span class="line">181</span><br><span class="line">182</span><br><span class="line">183</span><br><span class="line">184</span><br><span class="line">185</span><br><span class="line">186</span><br><span class="line">187</span><br><span class="line">188</span><br><span class="line">189</span><br><span class="line">190</span><br><span class="line">191</span><br><span class="line">192</span><br><span class="line">193</span><br><span class="line">194</span><br><span class="line">195</span><br><span class="line">196</span><br><span class="line">197</span><br><span class="line">198</span><br><span class="line">199</span><br><span class="line">200</span><br><span class="line">201</span><br><span class="line">202</span><br><span class="line">203</span><br><span class="line">204</span><br><span class="line">205</span><br><span class="line">206</span><br><span class="line">207</span><br><span class="line">208</span><br><span class="line">209</span><br><span class="line">210</span><br><span class="line">211</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> tqdm <span class="keyword">import</span> trange</span><br><span class="line"><span class="keyword">from</span> Crypto.Cipher <span class="keyword">import</span> AES</span><br><span class="line"><span class="keyword">from</span> hashlib <span class="keyword">import</span> md5</span><br><span class="line"></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">TropicalPairElement</span>(<span class="title class_ inherited__">CommutativeRingElement</span>):</span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">__init__</span>(<span class="params">self, parent, a1, a2, c=<span class="literal">None</span></span>):</span><br><span class="line">        CommutativeRingElement.__init__(<span class="variable language_">self</span>, parent)</span><br><span class="line">        <span class="variable language_">self</span>.a1 = a1</span><br><span class="line">        <span class="variable language_">self</span>.a2 = a2</span><br><span class="line">        <span class="variable language_">self</span>.c = c</span><br><span class="line"></span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">__add__</span>(<span class="params">self, other</span>):</span><br><span class="line">        <span class="keyword">return</span> TropicalPairElement(</span><br><span class="line">            <span class="variable language_">self</span>.parent(), <span class="built_in">max</span>(<span class="variable language_">self</span>.a1, other.a1), <span class="built_in">max</span>(<span class="variable language_">self</span>.a2, other.a2), c=<span class="variable language_">self</span>.c</span><br><span class="line">        )</span><br><span class="line"></span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">__mul__</span>(<span class="params">self, other</span>):</span><br><span class="line">        p = <span class="number">0</span></span><br><span class="line">        <span class="keyword">if</span> <span class="variable language_">self</span>.c <span class="keyword">is</span> <span class="keyword">not</span> <span class="literal">None</span>:</span><br><span class="line">            p += <span class="variable language_">self</span>.c</span><br><span class="line">        first = <span class="built_in">max</span>(p + <span class="variable language_">self</span>.a1 + other.a1, p + <span class="variable language_">self</span>.a2 + other.a2)</span><br><span class="line">        second = <span class="built_in">max</span>(p + <span class="variable language_">self</span>.a1 + other.a2, p + <span class="variable language_">self</span>.a2 + other.a1)</span><br><span class="line">        <span class="keyword">return</span> TropicalPairElement(<span class="variable language_">self</span>.parent(), first, second, c=<span class="variable language_">self</span>.c)</span><br><span class="line"></span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">__eq__</span>(<span class="params">self, other</span>):</span><br><span class="line">        <span class="keyword">return</span> (<span class="variable language_">self</span>.a1 == other.a1) <span class="keyword">and</span> (<span class="variable language_">self</span>.a2 == other.a2)</span><br><span class="line"></span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">__ne__</span>(<span class="params">self, other</span>):</span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">not</span> <span class="variable language_">self</span>.__eq__(other)</span><br><span class="line"></span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">is_zero</span>(<span class="params">self</span>):</span><br><span class="line">        <span class="keyword">return</span> <span class="variable language_">self</span>.a1 == <span class="built_in">float</span>(<span class="string">&quot;-inf&quot;</span>) <span class="keyword">and</span> <span class="variable language_">self</span>.a2 == <span class="built_in">float</span>(<span class="string">&quot;-inf&quot;</span>)</span><br><span class="line"></span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">__repr__</span>(<span class="params">self</span>):</span><br><span class="line">        <span class="keyword">return</span> <span class="string">f&quot;T(<span class="subst">&#123;self.a1&#125;</span>, <span class="subst">&#123;self.a2&#125;</span>)&quot;</span></span><br><span class="line"></span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">_mul_</span>(<span class="params">self, other</span>):</span><br><span class="line">        <span class="keyword">return</span> <span class="variable language_">self</span>.__mul__(other)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">TropicalPairSemiring</span>(UniqueRepresentation, Parent):</span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">__init__</span>(<span class="params">self, c=<span class="literal">None</span></span>):</span><br><span class="line">        Parent.__init__(<span class="variable language_">self</span>, category=CommutativeRings())</span><br><span class="line">        <span class="variable language_">self</span>.c = c</span><br><span class="line"></span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">_element_constructor_</span>(<span class="params">self, a1, a2</span>):</span><br><span class="line">        <span class="keyword">return</span> TropicalPairElement(<span class="variable language_">self</span>, a1, a2, <span class="variable language_">self</span>.c)</span><br><span class="line"></span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">__repr__</span>(<span class="params">self</span>):</span><br><span class="line">        <span class="keyword">return</span> <span class="string">&quot;Tropical Semiring of Pairs&quot;</span></span><br><span class="line"></span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">zero</span>(<span class="params">self</span>):</span><br><span class="line">        <span class="keyword">return</span> <span class="variable language_">self</span>(<span class="built_in">float</span>(<span class="string">&quot;-inf&quot;</span>), <span class="built_in">float</span>(<span class="string">&quot;-inf&quot;</span>))</span><br><span class="line"></span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">one</span>(<span class="params">self</span>):</span><br><span class="line">        <span class="keyword">return</span> <span class="variable language_">self</span>(<span class="number">0</span>, <span class="built_in">float</span>(<span class="string">&quot;-inf&quot;</span>))</span><br><span class="line"></span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">random_element</span>(<span class="params">self, lower_bound=-<span class="number">10</span>, upper_bound=<span class="number">10</span></span>):</span><br><span class="line">        <span class="keyword">from</span> random <span class="keyword">import</span> randint</span><br><span class="line"></span><br><span class="line">        a1 = randint(lower_bound, upper_bound)</span><br><span class="line">        a2 = randint(lower_bound, upper_bound)</span><br><span class="line">        <span class="keyword">return</span> <span class="variable language_">self</span>._element_constructor_(a1, a2)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">change_ring</span>(<span class="params">matrix, ring</span>):</span><br><span class="line">    n = <span class="built_in">len</span>(matrix[<span class="number">0</span>, :].<span class="built_in">list</span>())</span><br><span class="line">    new_matrix = [</span><br><span class="line">        [ring(matrix[i, j].a1, matrix[i, j].a2) <span class="keyword">for</span> j <span class="keyword">in</span> <span class="built_in">range</span>(n)] <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(n)</span><br><span class="line">    ]</span><br><span class="line">    <span class="keyword">return</span> Matrix(ring, new_matrix)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">TropicalElement</span>(<span class="title class_ inherited__">CommutativeRingElement</span>):</span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">__init__</span>(<span class="params">self, parent, a</span>):</span><br><span class="line">        CommutativeRingElement.__init__(<span class="variable language_">self</span>, parent)</span><br><span class="line">        <span class="variable language_">self</span>.a = a</span><br><span class="line"></span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">__add__</span>(<span class="params">self, other</span>):</span><br><span class="line">        <span class="keyword">return</span> TropicalElement(<span class="variable language_">self</span>.parent(), <span class="built_in">max</span>(<span class="variable language_">self</span>.a, other.a))</span><br><span class="line"></span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">__sub__</span>(<span class="params">self, other</span>):</span><br><span class="line">        <span class="keyword">return</span> TropicalElement(<span class="variable language_">self</span>.parent(), <span class="variable language_">self</span>.a - other.a)</span><br><span class="line"></span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">__mul__</span>(<span class="params">self, other</span>):</span><br><span class="line">        <span class="keyword">return</span> TropicalElement(<span class="variable language_">self</span>.parent(), <span class="variable language_">self</span>.a + other.a)</span><br><span class="line"></span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">__eq__</span>(<span class="params">self, other</span>):</span><br><span class="line">        <span class="keyword">return</span> <span class="variable language_">self</span>.a == other.a</span><br><span class="line"></span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">__ne__</span>(<span class="params">self, other</span>):</span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">not</span> <span class="variable language_">self</span>.__eq__(other)</span><br><span class="line"></span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">is_zero</span>(<span class="params">self</span>):</span><br><span class="line">        <span class="keyword">return</span> <span class="variable language_">self</span>.a == <span class="built_in">float</span>(<span class="string">&quot;-inf&quot;</span>)</span><br><span class="line"></span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">__repr__</span>(<span class="params">self</span>):</span><br><span class="line">        <span class="keyword">return</span> <span class="string">f&quot;T(<span class="subst">&#123;self.a&#125;</span>)&quot;</span></span><br><span class="line"></span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">_mul_</span>(<span class="params">self, other</span>):</span><br><span class="line">        <span class="keyword">return</span> <span class="variable language_">self</span>.__mul__(other)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">TropicalSemiring</span>(UniqueRepresentation, Parent):</span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">__init__</span>(<span class="params">self</span>):</span><br><span class="line">        Parent.__init__(<span class="variable language_">self</span>, category=CommutativeRings())</span><br><span class="line"></span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">_element_constructor_</span>(<span class="params">self, a</span>):</span><br><span class="line">        <span class="keyword">return</span> TropicalElement(<span class="variable language_">self</span>, a)</span><br><span class="line"></span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">__repr__</span>(<span class="params">self</span>):</span><br><span class="line">        <span class="keyword">return</span> <span class="string">&quot;Tropical Semiring of Pairs&quot;</span></span><br><span class="line"></span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">zero</span>(<span class="params">self</span>):</span><br><span class="line">        <span class="keyword">return</span> <span class="variable language_">self</span>(<span class="built_in">float</span>(<span class="string">&quot;-inf&quot;</span>))</span><br><span class="line"></span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">one</span>(<span class="params">self</span>):</span><br><span class="line">        <span class="keyword">return</span> <span class="variable language_">self</span>(<span class="number">0</span>)</span><br><span class="line"></span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">random_element</span>(<span class="params">self, lower_bound=-<span class="number">10</span>, upper_bound=<span class="number">10</span></span>):</span><br><span class="line">        <span class="keyword">from</span> random <span class="keyword">import</span> randint</span><br><span class="line"></span><br><span class="line">        a = randint(lower_bound, upper_bound)</span><br><span class="line">        <span class="keyword">return</span> <span class="variable language_">self</span>._element_constructor_(a)</span><br><span class="line"></span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">get_identity_matrix</span>(<span class="params">self, n</span>):</span><br><span class="line">        <span class="keyword">return</span> Matrix(<span class="variable language_">self</span>,[[<span class="variable language_">self</span>.one() <span class="keyword">if</span> i == j <span class="keyword">else</span> <span class="variable language_">self</span>.zero() <span class="keyword">for</span> j <span class="keyword">in</span> <span class="built_in">range</span>(n)] <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(n)])</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">shift</span>(<span class="params">matrix, x</span>):</span><br><span class="line">    n = <span class="built_in">len</span>(matrix[<span class="number">0</span>, :].<span class="built_in">list</span>())</span><br><span class="line">    ring = matrix.base_ring()</span><br><span class="line">    new_matrix = [[ring(matrix[i, j].a1 + x, matrix[i, j].a2 + x) <span class="keyword">if</span> <span class="built_in">isinstance</span>(matrix[i, j], TropicalPairElement) <span class="keyword">else</span> ring(matrix[i, j].a + x) <span class="keyword">for</span> j <span class="keyword">in</span> <span class="built_in">range</span>(n)] <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(n)]</span><br><span class="line">    <span class="keyword">return</span> Matrix(ring, new_matrix)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">pair_to_Semiring</span>(<span class="params">matrix</span>):</span><br><span class="line">    Q = TropicalSemiring()</span><br><span class="line">    Y = []</span><br><span class="line">    n = <span class="built_in">len</span>(matrix[<span class="number">0</span>, :].<span class="built_in">list</span>())</span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(n):</span><br><span class="line">        Y_row = []</span><br><span class="line">        <span class="keyword">for</span> j <span class="keyword">in</span> <span class="built_in">range</span>(n):</span><br><span class="line">            Y_row.append(Q(matrix[i, j].a1))</span><br><span class="line">            Y_row.append(Q(matrix[i, j].a2))</span><br><span class="line">        Y.append(Y_row)</span><br><span class="line">        Y_row = []</span><br><span class="line">        <span class="keyword">for</span> j <span class="keyword">in</span> <span class="built_in">range</span>(n):</span><br><span class="line">            Y_row.append(Q(matrix[i, j].a2))</span><br><span class="line">            Y_row.append(Q(matrix[i, j].a1))</span><br><span class="line">        Y.append(Y_row)</span><br><span class="line">    <span class="keyword">return</span> Matrix(Q, Y)</span><br><span class="line">    </span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">Semiring_to_pair</span>(<span class="params">matrix</span>):</span><br><span class="line">    Q = TropicalPairSemiring()</span><br><span class="line">    Y = []</span><br><span class="line">    n = <span class="built_in">len</span>(matrix[<span class="number">0</span>, :].<span class="built_in">list</span>()) // <span class="number">2</span></span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">0</span>, <span class="number">2</span> * n, <span class="number">2</span>):</span><br><span class="line">        YY = []</span><br><span class="line">        <span class="keyword">for</span> j <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">0</span>, n):</span><br><span class="line">            YY.append(Q(matrix[i,<span class="number">2</span>*j].a,matrix[i,<span class="number">2</span>*j+<span class="number">1</span>].a))</span><br><span class="line">        Y.append(YY)</span><br><span class="line">    <span class="keyword">return</span> Matrix(Q, Y)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">check</span>(<span class="params">X</span>):</span><br><span class="line">    a = X[<span class="number">0</span>, <span class="number">0</span>]</span><br><span class="line">    <span class="keyword">for</span> element <span class="keyword">in</span> X.<span class="built_in">list</span>():</span><br><span class="line">        <span class="keyword">if</span> element != a:</span><br><span class="line">            <span class="keyword">return</span> <span class="literal">False</span></span><br><span class="line">    <span class="keyword">return</span> <span class="literal">True</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">attack</span>(<span class="params">U, D1, M, D2, maxt=<span class="literal">None</span></span>):</span><br><span class="line">    <span class="keyword">if</span> maxt == <span class="literal">None</span>:</span><br><span class="line">        maxt = <span class="built_in">len</span>(U[<span class="number">0</span>, :].<span class="built_in">list</span>()) ** <span class="number">3</span></span><br><span class="line">    D1_ = [D1**i <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(maxt)]</span><br><span class="line">    D2_ = [D2**i <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(maxt)]</span><br><span class="line">    <span class="keyword">for</span> t1 <span class="keyword">in</span> trange(maxt):</span><br><span class="line">        <span class="keyword">for</span> t2 <span class="keyword">in</span> <span class="built_in">range</span>(maxt):</span><br><span class="line">            T = U - D1_[t1] * M * D2_[t2]</span><br><span class="line">            <span class="keyword">if</span> check(T):</span><br><span class="line">                <span class="keyword">yield</span> (<span class="built_in">int</span>(T[<span class="number">0</span>, <span class="number">0</span>].a), t1, t2)</span><br><span class="line"></span><br><span class="line">n = <span class="number">3</span></span><br><span class="line">T = TropicalPairSemiring()</span><br><span class="line"></span><br><span class="line">enc = <span class="string">b&#x27;\x88I\xa6\xa5\x83\x8a\xd3$dk/\xf9\xdb\xc7\xec\xe8\xf6\x8c\x9d\xad\xe7\x8d\xb8\xe73~&amp;\xb6O\xe5\x0f\x12\xf3?@\xd4\xc6I\xeel\x9d\xdd8\x92*gY`&#x27;</span></span><br><span class="line">X = [T(<span class="number">59900590664029081588751597115949479657291730864508459758763562295986654520462</span>, <span class="number">68320552779283515276240499643319977619901440989200422494626425642962224959344</span>), T(<span class="number">89698054093719949422762429034310548012077225043893131168337545047107450749496</span>, <span class="number">51479199576292239130066082976332639976062899059190752269878695108378488146679</span>), T(<span class="number">62218736027330266192570144338062026977337231944985836220559539768109014406831</span>, <span class="number">61214354159525954062640070826510640683451706120539795727362849462686622564693</span>), T(<span class="number">39805827211060089460158250456599968341463470401750393132792110953878249393569</span>, <span class="number">99103416592859133938491410425030428643259368893929508081326035011417306901272</span>), T(<span class="number">20922493031536155240718266043337868355652138270147183521353456319726724009058</span>, <span class="number">31430964180770964194690164159235543367301572045989047438624310779165592317271</span>), T(<span class="number">8959191626315499956806224120588498434035126032025230565571486221513367178374</span>, <span class="number">20067214390603904748675229391030612573671604470294660618614875919888930884780</span>), T(<span class="number">66048220278298402781571427858585494416782927078968140383635650050886579125833</span>, <span class="number">18175597939833315588572188448012546734970985103503074208793106634216584036818</span>), T(<span class="number">14432081053446841732493980558668616443341123394659689880088380115934894274635</span>, <span class="number">83557493069309650142798328460651561327339732728386566873314215777128303177667</span>), T(<span class="number">34511162979554971448736265846077014796752072453004958739933710734947541396694</span>, <span class="number">77364571020765493103034943723333754233327577188690990300833856668531817680505</span>)]</span><br><span class="line">Y = [T(<span class="number">78533528545456238383274783853785358016819467733594018596743219756487720633746</span>, <span class="number">93976221569207299395273293543645974643384826524816615562497005292252667770601</span>), T(<span class="number">103766862112463335445955325531890205089005117500922857426350491681602103969000</span>, <span class="number">47323529900779960229909476477918095608118443655903527805237066535366116839149</span>), T(<span class="number">10190752330406968772077432866677538790850926811710030717810026338836331450472</span>, <span class="number">86375880251137784911361557173115785351126971447566503084261189167084220453288</span>), T(<span class="number">13780196681979042044702022951434986810164135209191561823725939514845972817610</span>, <span class="number">55170363535880083300862447306063246181282182639154190917220001586753468629546</span>), T(<span class="number">436029875577652990270691130860178026240806299188121622633421834221330373636</span>, <span class="number">110804259765120571425960874898903708961853698355143533817410855395636486531982</span>), T(<span class="number">6397911849400997286703265695504239070876241554571709807303889197285939312681</span>, <span class="number">17360696619752702589750097897661044951586752285334140009669640422948343241568</span>), T(<span class="number">58041034583523761593801980039841494595215125402194920275127841961766699686394</span>, <span class="number">54766044749028865088458074550257196739016298676359665986238379481142351990626</span>), T(<span class="number">77530103367856397256662107816221151235947660504364282548276904992741575506849</span>, <span class="number">63854892725980295947169956482257581700294549443273322483764382131671051522332</span>), T(<span class="number">47497441477952935509240863594022229337695084880724507207404445061842628668952</span>, <span class="number">56713418154978297086219120150091406983389112617302018465360827172758909144570</span>)]</span><br><span class="line">A_p = [T(<span class="number">40547797283575399311345964287271714617688023231464400205040285835460999315476731205228816544079212468645004319629302959473711018684702750872290449940972698</span>, <span class="number">40547797283575399311345964287271714617688023231464400205040285835460999315476698934497596879746169782553959201278357925243089469169482083236651301175074462</span>), T(<span class="number">40547797283575399311345964287271714617688023231464400205040285835460999315476786839125045784567337567072597160092083530989427008027602941726099332958875134</span>, <span class="number">40547797283575399311345964287271714617688023231464400205040285835460999315476750004263963436463523550691311785519855896914393402679802307379634177780083118</span>), T(<span class="number">40547797283575399311345964287271714617688023231464400205040285835460999315476706776849302561292697869327278531705692232746803441653969601206061897674894004</span>, <span class="number">40547797283575399311345964287271714617688023231464400205040285835460999315476682432777130064993198309463393760622192553532626436203592834759900982411655833</span>), T(<span class="number">40547797283575399311345964287271714617688023231464400205040285835460999315476733573193663026027748192077028026006061293036706834385224678998540725414561492</span>, <span class="number">40547797283575399311345964287271714617688023231464400205040285835460999315476709827727502107645065946715613329058910783689656325976029039752886304715182546</span>), T(<span class="number">40547797283575399311345964287271714617688023231464400205040285835460999315476789207089892266515873290504620866468841864552422823728124869852349608432463928</span>, <span class="number">40547797283575399311345964287271714617688023231464400205040285835460999315476765461623731348133191045143206169521691355205372315318929230606695187733084982</span>), T(<span class="number">40547797283575399311345964287271714617688023231464400205040285835460999315476709144814149043241233592759302238082450566309799257354491529332312173148482798</span>, <span class="number">40547797283575399311345964287271714617688023231464400205040285835460999315476685399347988124858551347397887541135300056962748748945295890086657752449103852</span>), T(<span class="number">40547797283575399311345964287271714617688023231464400205040285835460999315476692793936572469446889818453385542291673187750773962605187059907381322027502633</span>, <span class="number">40547797283575399311345964287271714617688023231464400205040285835460999315476725064667792133779932504544430660642618221981395512120407727543020470793400869</span>), T(<span class="number">40547797283575399311345964287271714617688023231464400205040285835460999315476746626235376326170902419020010827637210112057551060804659922530107892689013547</span>, <span class="number">40547797283575399311345964287271714617688023231464400205040285835460999315476780698564021374268057602972023501105398793497111501463307918396829353811303305</span>), T(<span class="number">40547797283575399311345964287271714617688023231464400205040285835460999315476676292216105654693918345362820101635507816040310929639297811430631003264084004</span>, <span class="number">40547797283575399311345964287271714617688023231464400205040285835460999315476700636288278150993417905226704872719007495254487935089674577876791918527322175</span>)]</span><br><span class="line">B_q = [T(<span class="number">44956584717324859629636950162153871886560739437959809729281253007078755840271381302732123072890496216398568268656559622476770594999251404506445788064037538</span>, <span class="number">44956584717324859629636950162153871886560739437959809729281253007078755840271413573463342737223538902489613387007504656707392144514472072142084936829935774</span>), T(<span class="number">44956584717324859629636950162153871886560739437959809729281253007078755840271432372498489629607849984535920852898057594148074528509571628649428664669046194</span>, <span class="number">44956584717324859629636950162153871886560739437959809729281253007078755840271469207359571977711664000917206227470285228223108133857372262995893819847838210</span>), T(<span class="number">44956584717324859629636950162153871886560739437959809729281253007078755840271364801011656258137524743308002828000394250766307562033362156029695469300618909</span>, <span class="number">44956584717324859629636950162153871886560739437959809729281253007078755840271389145083828754437024303171887599083893929980484567483738922475856384563857080</span>), T(<span class="number">44956584717324859629636950162153871886560739437959809729281253007078755840271392195962028300789392380560222396437112480923337451805798361022680791604145622</span>, <span class="number">44956584717324859629636950162153871886560739437959809729281253007078755840271415941428189219172074625921637093384262990270387960214994000268335212303524568</span>), T(<span class="number">44956584717324859629636950162153871886560739437959809729281253007078755840271447829858257541277517478987815236899893052439053441148698551876489674622048058</span>, <span class="number">44956584717324859629636950162153871886560739437959809729281253007078755840271471575324418459660199724349229933847043561786103949557894191122144095321427004</span>), T(<span class="number">44956584717324859629636950162153871886560739437959809729281253007078755840271367767582514318002877781242496608513501754196429874775065211356452239338066928</span>, <span class="number">44956584717324859629636950162153871886560739437959809729281253007078755840271391513048675236385560026603911305460652263543480383184260850602106660037445874</span>), T(<span class="number">44956584717324859629636950162153871886560739437959809729281253007078755840271407432902318326924258938389039728020819919215076637950177048812814957682363945</span>, <span class="number">44956584717324859629636950162153871886560739437959809729281253007078755840271375162171098662591216252297994609669874884984455088434956381177175808916465709</span>), T(<span class="number">44956584717324859629636950162153871886560739437959809729281253007078755840271463066798547567412384036816632568483600490730792627293077239666623840700266381</span>, <span class="number">44956584717324859629636950162153871886560739437959809729281253007078755840271428994469902519315228852864619895015411809291232186634429243799902379577976623</span>), T(<span class="number">44956584717324859629636950162153871886560739437959809729281253007078755840271383004522804344137744339071313940097209192488169060919443899146586405416285251</span>, <span class="number">44956584717324859629636950162153871886560739437959809729281253007078755840271358660450631847838244779207429169013709513273992055469067132700425490153047080</span>)]</span><br><span class="line">X = Matrix(T, [X[<span class="number">3</span>*i:<span class="number">3</span>*(i+<span class="number">1</span>)] <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">3</span>)])</span><br><span class="line">Y = Matrix(T, [Y[<span class="number">3</span>*i:<span class="number">3</span>*(i+<span class="number">1</span>)] <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">3</span>)])</span><br><span class="line">A_p = Matrix(T, [A_p[<span class="number">3</span>*i:<span class="number">3</span>*(i+<span class="number">1</span>)] <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">3</span>)])</span><br><span class="line">B_q = Matrix(T, [B_q[<span class="number">3</span>*i:<span class="number">3</span>*(i+<span class="number">1</span>)] <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">3</span>)])</span><br><span class="line">M = TropicalSemiring().get_identity_matrix(<span class="number">2</span>*n)</span><br><span class="line">X_ = pair_to_Semiring(X)</span><br><span class="line">Y_ = pair_to_Semiring(Y)</span><br><span class="line">A_p_ = pair_to_Semiring(A_p)</span><br><span class="line">B_q_ = pair_to_Semiring(B_q)</span><br><span class="line"><span class="keyword">for</span> t, k_, l_ <span class="keyword">in</span> attack(A_p_, X_, M, Y_):</span><br><span class="line">    K = shift((X_**k_ * B_q_ * Y_**l_), t)</span><br><span class="line">    key = md5(<span class="built_in">str</span>(Semiring_to_pair(K)).encode()).digest()</span><br><span class="line">    aes = AES.new(key=key, mode=AES.MODE_ECB)</span><br><span class="line">    flag = aes.decrypt(enc)</span><br><span class="line">    <span class="keyword">if</span> <span class="string">b&#x27;LZSDS&#x27;</span> <span class="keyword">in</span> flag:</span><br><span class="line">        <span class="built_in">print</span>(flag)</span><br><span class="line">        <span class="keyword">break</span></span><br><span class="line"><span class="comment"># LZSDS&#123;dbc6bad4-7e16-4883-b7a1-682333a18c7c&#125;</span></span><br></pre></td></tr></table></figure>
<h1 id="misc"><a class="markdownIt-Anchor" href="#misc"></a> MISC</h1>
<h2 id="golf"><a class="markdownIt-Anchor" href="#golf"></a> golf</h2>
<p>题目</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> base64</span><br><span class="line"></span><br><span class="line">flag = <span class="built_in">open</span>(<span class="string">&#x27;flag&#x27;</span>, <span class="string">&#x27;r&#x27;</span>).read()</span><br><span class="line">BOX = [<span class="string">&#x27;63&#x27;</span>, <span class="string">&#x27;7c&#x27;</span>, <span class="string">&#x27;77&#x27;</span>, <span class="string">&#x27;7b&#x27;</span>, <span class="string">&#x27;f2&#x27;</span>, <span class="string">&#x27;6b&#x27;</span>, <span class="string">&#x27;6f&#x27;</span>, <span class="string">&#x27;c5&#x27;</span>, <span class="string">&#x27;30&#x27;</span>, <span class="string">&#x27;01&#x27;</span>, <span class="string">&#x27;67&#x27;</span>, <span class="string">&#x27;2b&#x27;</span>, <span class="string">&#x27;fe&#x27;</span>, <span class="string">&#x27;d7&#x27;</span>, <span class="string">&#x27;ab&#x27;</span>, <span class="string">&#x27;76&#x27;</span>, <span class="string">&#x27;ca&#x27;</span>, <span class="string">&#x27;82&#x27;</span>, <span class="string">&#x27;c9&#x27;</span>, <span class="string">&#x27;7d&#x27;</span>, <span class="string">&#x27;fa&#x27;</span>, <span class="string">&#x27;59&#x27;</span>, <span class="string">&#x27;47&#x27;</span>, <span class="string">&#x27;f0&#x27;</span>, <span class="string">&#x27;ad&#x27;</span>, <span class="string">&#x27;d4&#x27;</span>, <span class="string">&#x27;a2&#x27;</span>, <span class="string">&#x27;af&#x27;</span>, <span class="string">&#x27;9c&#x27;</span>, <span class="string">&#x27;a4&#x27;</span>, <span class="string">&#x27;72&#x27;</span>, <span class="string">&#x27;c0&#x27;</span>, <span class="string">&#x27;b7&#x27;</span>, <span class="string">&#x27;fd&#x27;</span>, <span class="string">&#x27;93&#x27;</span>, <span class="string">&#x27;26&#x27;</span>, <span class="string">&#x27;36&#x27;</span>, <span class="string">&#x27;3f&#x27;</span>, <span class="string">&#x27;f7&#x27;</span>, <span class="string">&#x27;cc&#x27;</span>, <span class="string">&#x27;34&#x27;</span>, <span class="string">&#x27;a5&#x27;</span>, <span class="string">&#x27;e5&#x27;</span>, <span class="string">&#x27;f1&#x27;</span>, <span class="string">&#x27;71&#x27;</span>, <span class="string">&#x27;d8&#x27;</span>, <span class="string">&#x27;31&#x27;</span>, <span class="string">&#x27;15&#x27;</span>, <span class="string">&#x27;04&#x27;</span>, <span class="string">&#x27;c7&#x27;</span>, <span class="string">&#x27;23&#x27;</span>, <span class="string">&#x27;c3&#x27;</span>, <span class="string">&#x27;18&#x27;</span>, <span class="string">&#x27;96&#x27;</span>, <span class="string">&#x27;05&#x27;</span>, <span class="string">&#x27;9a&#x27;</span>, <span class="string">&#x27;07&#x27;</span>, <span class="string">&#x27;12&#x27;</span>, <span class="string">&#x27;80&#x27;</span>, <span class="string">&#x27;e2&#x27;</span>, <span class="string">&#x27;eb&#x27;</span>, <span class="string">&#x27;27&#x27;</span>, <span class="string">&#x27;b2&#x27;</span>, <span class="string">&#x27;75&#x27;</span>, <span class="string">&#x27;09&#x27;</span>, <span class="string">&#x27;83&#x27;</span>, <span class="string">&#x27;2c&#x27;</span>, <span class="string">&#x27;1a&#x27;</span>, <span class="string">&#x27;1b&#x27;</span>, <span class="string">&#x27;6e&#x27;</span>, <span class="string">&#x27;5a&#x27;</span>, <span class="string">&#x27;a0&#x27;</span>, <span class="string">&#x27;52&#x27;</span>, <span class="string">&#x27;3b&#x27;</span>, <span class="string">&#x27;d6&#x27;</span>, <span class="string">&#x27;b3&#x27;</span>, <span class="string">&#x27;29&#x27;</span>, <span class="string">&#x27;e3&#x27;</span>, <span class="string">&#x27;2f&#x27;</span>, <span class="string">&#x27;84&#x27;</span>, <span class="string">&#x27;53&#x27;</span>, <span class="string">&#x27;d1&#x27;</span>, <span class="string">&#x27;00&#x27;</span>, <span class="string">&#x27;ed&#x27;</span>, <span class="string">&#x27;20&#x27;</span>, <span class="string">&#x27;fc&#x27;</span>, <span class="string">&#x27;b1&#x27;</span>, <span class="string">&#x27;5b&#x27;</span>, <span class="string">&#x27;6a&#x27;</span>, <span class="string">&#x27;cb&#x27;</span>, <span class="string">&#x27;be&#x27;</span>, <span class="string">&#x27;39&#x27;</span>, <span class="string">&#x27;4a&#x27;</span>, <span class="string">&#x27;4c&#x27;</span>, <span class="string">&#x27;58&#x27;</span>, <span class="string">&#x27;cf&#x27;</span>, <span class="string">&#x27;d0&#x27;</span>, <span class="string">&#x27;ef&#x27;</span>, <span class="string">&#x27;aa&#x27;</span>, <span class="string">&#x27;fb&#x27;</span>, <span class="string">&#x27;43&#x27;</span>, <span class="string">&#x27;4d&#x27;</span>, <span class="string">&#x27;33&#x27;</span>, <span class="string">&#x27;85&#x27;</span>, <span class="string">&#x27;45&#x27;</span>, <span class="string">&#x27;f9&#x27;</span>, <span class="string">&#x27;02&#x27;</span>, <span class="string">&#x27;7f&#x27;</span>, <span class="string">&#x27;50&#x27;</span>, <span class="string">&#x27;3c&#x27;</span>, <span class="string">&#x27;9f&#x27;</span>, <span class="string">&#x27;a8&#x27;</span>, <span class="string">&#x27;51&#x27;</span>, <span class="string">&#x27;a3&#x27;</span>, <span class="string">&#x27;40&#x27;</span>, <span class="string">&#x27;8f&#x27;</span>, <span class="string">&#x27;92&#x27;</span>, <span class="string">&#x27;9d&#x27;</span>, <span class="string">&#x27;38&#x27;</span>, <span class="string">&#x27;f5&#x27;</span>, <span class="string">&#x27;bc&#x27;</span>, <span class="string">&#x27;b6&#x27;</span>, <span class="string">&#x27;da&#x27;</span>, <span class="string">&#x27;21&#x27;</span>, <span class="string">&#x27;10&#x27;</span>, <span class="string">&#x27;ff&#x27;</span>, <span class="string">&#x27;f3&#x27;</span>, <span class="string">&#x27;d2&#x27;</span>, <span class="string">&#x27;cd&#x27;</span>, <span class="string">&#x27;0c&#x27;</span>, <span class="string">&#x27;13&#x27;</span>, <span class="string">&#x27;ec&#x27;</span>, <span class="string">&#x27;5f&#x27;</span>, <span class="string">&#x27;97&#x27;</span>, <span class="string">&#x27;44&#x27;</span>, <span class="string">&#x27;17&#x27;</span>, <span class="string">&#x27;c4&#x27;</span>, <span class="string">&#x27;a7&#x27;</span>, <span class="string">&#x27;7e&#x27;</span>, <span class="string">&#x27;3d&#x27;</span>, <span class="string">&#x27;64&#x27;</span>, <span class="string">&#x27;5d&#x27;</span>, <span class="string">&#x27;19&#x27;</span>, <span class="string">&#x27;73&#x27;</span>, <span class="string">&#x27;60&#x27;</span>, <span class="string">&#x27;81&#x27;</span>, <span class="string">&#x27;4f&#x27;</span>, <span class="string">&#x27;dc&#x27;</span>, <span class="string">&#x27;22&#x27;</span>, <span class="string">&#x27;2a&#x27;</span>, <span class="string">&#x27;90&#x27;</span>, <span class="string">&#x27;88&#x27;</span>, <span class="string">&#x27;46&#x27;</span>, <span class="string">&#x27;ee&#x27;</span>, <span class="string">&#x27;b8&#x27;</span>, <span class="string">&#x27;14&#x27;</span>, <span class="string">&#x27;de&#x27;</span>, <span class="string">&#x27;5e&#x27;</span>, <span class="string">&#x27;0b&#x27;</span>, <span class="string">&#x27;db&#x27;</span>, <span class="string">&#x27;e0&#x27;</span>, <span class="string">&#x27;32&#x27;</span>, <span class="string">&#x27;3a&#x27;</span>, <span class="string">&#x27;0a&#x27;</span>, <span class="string">&#x27;49&#x27;</span>, <span class="string">&#x27;06&#x27;</span>, <span class="string">&#x27;24&#x27;</span>, <span class="string">&#x27;5c&#x27;</span>, <span class="string">&#x27;c2&#x27;</span>, <span class="string">&#x27;d3&#x27;</span>, <span class="string">&#x27;ac&#x27;</span>, <span class="string">&#x27;62&#x27;</span>, <span class="string">&#x27;91&#x27;</span>, <span class="string">&#x27;95&#x27;</span>, <span class="string">&#x27;e4&#x27;</span>, <span class="string">&#x27;79&#x27;</span>, <span class="string">&#x27;e7&#x27;</span>, <span class="string">&#x27;c8&#x27;</span>, <span class="string">&#x27;37&#x27;</span>, <span class="string">&#x27;6d&#x27;</span>, <span class="string">&#x27;8d&#x27;</span>, <span class="string">&#x27;d5&#x27;</span>, <span class="string">&#x27;4e&#x27;</span>, <span class="string">&#x27;a9&#x27;</span>, <span class="string">&#x27;6c&#x27;</span>, <span class="string">&#x27;56&#x27;</span>, <span class="string">&#x27;f4&#x27;</span>, <span class="string">&#x27;ea&#x27;</span>, <span class="string">&#x27;65&#x27;</span>, <span class="string">&#x27;7a&#x27;</span>, <span class="string">&#x27;ae&#x27;</span>, <span class="string">&#x27;08&#x27;</span>, <span class="string">&#x27;ba&#x27;</span>, <span class="string">&#x27;78&#x27;</span>, <span class="string">&#x27;25&#x27;</span>, <span class="string">&#x27;2e&#x27;</span>, <span class="string">&#x27;1c&#x27;</span>, <span class="string">&#x27;a6&#x27;</span>, <span class="string">&#x27;b4&#x27;</span>, <span class="string">&#x27;c6&#x27;</span>, <span class="string">&#x27;e8&#x27;</span>, <span class="string">&#x27;dd&#x27;</span>, <span class="string">&#x27;74&#x27;</span>, <span class="string">&#x27;1f&#x27;</span>, <span class="string">&#x27;4b&#x27;</span>, <span class="string">&#x27;bd&#x27;</span>, <span class="string">&#x27;8b&#x27;</span>, <span class="string">&#x27;8a&#x27;</span>, <span class="string">&#x27;70&#x27;</span>, <span class="string">&#x27;3e&#x27;</span>, <span class="string">&#x27;b5&#x27;</span>, <span class="string">&#x27;66&#x27;</span>, <span class="string">&#x27;48&#x27;</span>, <span class="string">&#x27;03&#x27;</span>, <span class="string">&#x27;f6&#x27;</span>, <span class="string">&#x27;0e&#x27;</span>, <span class="string">&#x27;61&#x27;</span>, <span class="string">&#x27;35&#x27;</span>, <span class="string">&#x27;57&#x27;</span>, <span class="string">&#x27;b9&#x27;</span>, <span class="string">&#x27;86&#x27;</span>, <span class="string">&#x27;c1&#x27;</span>, <span class="string">&#x27;1d&#x27;</span>, <span class="string">&#x27;9e&#x27;</span>, <span class="string">&#x27;e1&#x27;</span>, <span class="string">&#x27;f8&#x27;</span>, <span class="string">&#x27;98&#x27;</span>, <span class="string">&#x27;11&#x27;</span>, <span class="string">&#x27;69&#x27;</span>, <span class="string">&#x27;d9&#x27;</span>, <span class="string">&#x27;8e&#x27;</span>, <span class="string">&#x27;94&#x27;</span>, <span class="string">&#x27;9b&#x27;</span>, <span class="string">&#x27;1e&#x27;</span>, <span class="string">&#x27;87&#x27;</span>, <span class="string">&#x27;e9&#x27;</span>, <span class="string">&#x27;ce&#x27;</span>, <span class="string">&#x27;55&#x27;</span>, <span class="string">&#x27;28&#x27;</span>, <span class="string">&#x27;df&#x27;</span>, <span class="string">&#x27;8c&#x27;</span>, <span class="string">&#x27;a1&#x27;</span>, <span class="string">&#x27;89&#x27;</span>, <span class="string">&#x27;0d&#x27;</span>, <span class="string">&#x27;bf&#x27;</span>, <span class="string">&#x27;e6&#x27;</span>, <span class="string">&#x27;42&#x27;</span>, <span class="string">&#x27;68&#x27;</span>, <span class="string">&#x27;41&#x27;</span>, <span class="string">&#x27;99&#x27;</span>, <span class="string">&#x27;2d&#x27;</span>, <span class="string">&#x27;0f&#x27;</span>, <span class="string">&#x27;b0&#x27;</span>, <span class="string">&#x27;54&#x27;</span>, <span class="string">&#x27;bb&#x27;</span>, <span class="string">&#x27;16&#x27;</span>]</span><br><span class="line">s = <span class="literal">None</span></span><br><span class="line"><span class="built_in">print</span>(<span class="string">&#x27;give me your solve:&#x27;</span>)</span><br><span class="line">inp = base64.b64decode(<span class="built_in">input</span>().encode()).decode()</span><br><span class="line">blacklist = [<span class="string">&#x27;BOX&#x27;</span>, <span class="string">&#x27;flag&#x27;</span>, <span class="string">&#x27;import&#x27;</span>, <span class="string">&#x27;os&#x27;</span>, <span class="string">&#x27;sys&#x27;</span>, <span class="string">&#x27;subprocess&#x27;</span>, <span class="string">&#x27;eval&#x27;</span>, <span class="string">&#x27;exec&#x27;</span>, <span class="string">&#x27;_&#x27;</span>, <span class="string">&#x27;open&#x27;</span>, <span class="string">&#x27;compile&#x27;</span>, <span class="string">&#x27;globals&#x27;</span>, <span class="string">&#x27;locals&#x27;</span>, <span class="string">&#x27;vars&#x27;</span>, <span class="string">&#x27;setattr&#x27;</span>, <span class="string">&#x27;getattr&#x27;</span>, <span class="string">&#x27;dir&#x27;</span>, <span class="string">&#x27;read&#x27;</span>, <span class="string">&#x27;chr&#x27;</span>, <span class="string">&#x27;help&#x27;</span>, <span class="string">&#x27;breakpoint&#x27;</span>]</span><br><span class="line"><span class="keyword">assert</span> <span class="built_in">all</span>(i <span class="keyword">not</span> <span class="keyword">in</span> inp <span class="keyword">for</span> i <span class="keyword">in</span> blacklist) <span class="keyword">and</span> <span class="built_in">len</span>(inp) &lt;= <span class="number">187</span></span><br><span class="line"><span class="built_in">exec</span>(inp)</span><br><span class="line"><span class="keyword">if</span> BOX == s:</span><br><span class="line">    <span class="built_in">print</span>(flag)</span><br></pre></td></tr></table></figure>
<p>给非烂了/(ㄒoㄒ)/~~</p>
<p>预期是在187个字符之内实现AES的BOX</p>
<p>做法不是很好说明，具体还是看exp吧</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> base64</span><br><span class="line"></span><br><span class="line">i = <span class="string">&quot;r=lambda x,s:(x&lt;&lt;s|x&gt;&gt;8-s)&amp;255\ns=[&#x27;63&#x27;]*256;p=q=1\nfor o in[0]*255:p=(p^(p*2)^[27,0][p&lt;128])&amp;255;q^=q*2;q^=q*4;q^=q*16;q&amp;=255;q^=[9,0][q&lt;128];s[p]=f&#x27;&#123;q^r(q,1)^r(q,2)^r(q,3)^r(q,4)^99:02x&#125;&#x27;&quot;</span></span><br><span class="line"><span class="built_in">print</span>(base64.b64encode(i.encode()).decode())</span><br><span class="line"><span class="built_in">print</span>(<span class="built_in">len</span>(i))</span><br><span class="line"><span class="comment"># cj1sYW1iZGEgeCxzOih4PDxzfHg+PjgtcykmMjU1CnM9Wyc2MyddKjI1NjtwPXE9MQpmb3IgbyBpblswXSoyNTU6cD0ocF4ocCoyKV5bMjcsMF1bcDwxMjhdKSYyNTU7cV49cSoyO3FePXEqNDtxXj1xKjE2O3EmPTI1NTtxXj1bOSwwXVtxPDEyOF07c1twXT1mJ3txXnIocSwxKV5yKHEsMilecihxLDMpXnIocSw0KV45OTowMnh9Jw==</span></span><br></pre></td></tr></table></figure>

    </div>

    
    
    

    <footer class="post-footer">
          <div class="post-tags">
              <a href="/tags/My-challenge/" rel="tag"><i class="fa fa-tag"></i> My challenge</a>
          </div>

        

          <div class="post-nav">
            <div class="post-nav-item">
                <a href="/2024/11/20/hello-world/" rel="prev" title="Hello World">
                  <i class="fa fa-angle-left"></i> Hello World
                </a>
            </div>
            <div class="post-nav-item">
                <a href="/2024/12/03/World-Wide-CTF-2024/" rel="next" title="World Wide CTF 2024">
                  World Wide CTF 2024 <i class="fa fa-angle-right"></i>
                </a>
            </div>
          </div>
    </footer>
  </article>
</div>






</div>
  </main>

  <footer class="footer">
    <div class="footer-inner">

  <div class="copyright">
    &copy; 
    <span itemprop="copyrightYear">2025</span>
    <span class="with-love">
      <i class="fa fa-heart"></i>
    </span>
    <span class="author" itemprop="copyrightHolder">languag3</span>
  </div>
  <div class="powered-by">由 <a href="https://hexo.io/" rel="noopener" target="_blank">Hexo</a> & <a href="https://theme-next.js.org/muse/" rel="noopener" target="_blank">NexT.Muse</a> 强力驱动
  </div>

    </div>
  </footer>

  
  <div class="toggle sidebar-toggle" role="button">
    <span class="toggle-line"></span>
    <span class="toggle-line"></span>
    <span class="toggle-line"></span>
  </div>
  <div class="sidebar-dimmer"></div>
  <div class="back-to-top" role="button" aria-label="返回顶部">
    <i class="fa fa-arrow-up fa-lg"></i>
    <span>0%</span>
  </div>

<noscript>
  <div class="noscript-warning">Theme NexT works best with JavaScript enabled</div>
</noscript>


  
  <script src="https://cdnjs.cloudflare.com/ajax/libs/animejs/3.2.1/anime.min.js" integrity="sha256-XL2inqUJaslATFnHdJOi9GfQ60on8Wx1C2H8DYiN1xY=" crossorigin="anonymous"></script>
<script src="/js/comments.js"></script><script src="/js/utils.js"></script><script src="/js/motion.js"></script><script src="/js/sidebar.js"></script><script src="/js/next-boot.js"></script>

  






  




  

  <script class="next-config" data-name="enableMath" type="application/json">true</script><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.16.9/katex.min.css" integrity="sha256-UF1fgpAiu3tPJN/uCqEUHNe7pnr+QR0SQDNfgglgtcM=" crossorigin="anonymous">
  <script class="next-config" data-name="katex" type="application/json">{"copy_tex_js":{"url":"https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.16.9/contrib/copy-tex.min.js","integrity":"sha256-Us54+rSGDSTvIhKKUs4kygE2ipA0RXpWWh0/zLqw3bs="}}</script>
  <script src="/js/third-party/math/katex.js"></script>



</body>
</html>
